import{a4 as Un,a5 as _n,a6 as Sn,a7 as xn,a8 as kn,s as dt,a9 as Tn,C as Pr,V as vt,g as wn,a as Br,aa as Fn,e as Cn,B as rn,ab as An,A as Dn,L as It,d as Nt,u as En,ac as pt,ad as Mn}from"./three.module-5Y2TLo_k.js";function Gn(){var c=Object.create(null);function t(r,e){var a=r.id,i=r.name,n=r.dependencies;n===void 0&&(n=[]);var o=r.init;o===void 0&&(o=function(){});var s=r.getTransferables;if(s===void 0&&(s=null),!c[a])try{n=n.map(function(f){return f&&f.isWorkerModule&&(t(f,function(u){if(u instanceof Error)throw u}),f=c[f.id].value),f}),o=h("<"+i+">.init",o),s&&(s=h("<"+i+">.getTransferables",s));var l=null;typeof o=="function"?l=o.apply(void 0,n):console.error("worker module init function failed to rehydrate"),c[a]={id:a,value:l,getTransferables:s},e(l)}catch(f){f&&f.noLog||console.error(f),e(f)}}function v(r,e){var a,i=r.id,n=r.args;(!c[i]||typeof c[i].value!="function")&&e(new Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var o=(a=c[i]).value.apply(a,n);o&&typeof o.then=="function"?o.then(s,function(l){return e(l instanceof Error?l:new Error(""+l))}):s(o)}catch(l){e(l)}function s(l){try{var f=c[i].getTransferables&&c[i].getTransferables(l);(!f||!Array.isArray(f)||!f.length)&&(f=void 0),e(l,f)}catch(u){console.error(u),e(u)}}}function h(r,e){var a=void 0;self.troikaDefine=function(n){return a=n};var i=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(i)}catch(n){console.error(n)}return URL.revokeObjectURL(i),delete self.troikaDefine,a}self.addEventListener("message",function(r){var e=r.data,a=e.messageId,i=e.action,n=e.data;try{i==="registerModule"&&t(n,function(o){o instanceof Error?postMessage({messageId:a,success:!1,error:o.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof o=="function"}})}),i==="callModule"&&v(n,function(o,s){o instanceof Error?postMessage({messageId:a,success:!1,error:o.message}):postMessage({messageId:a,success:!0,result:o},s||void 0)})}catch(o){postMessage({messageId:a,success:!1,error:o.stack})}})}function Rn(c){var t=function(){for(var v=[],h=arguments.length;h--;)v[h]=arguments[h];return t._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,v);throw new Error("Worker module function was called but `init` did not return a callable function")})};return t._getInitResult=function(){var v=c.dependencies,h=c.init;v=Array.isArray(v)?v.map(function(e){return e&&(e=e.onMainThread||e,e._getInitResult&&(e=e._getInitResult())),e}):[];var r=Promise.all(v).then(function(e){return h.apply(null,e)});return t._getInitResult=function(){return r},r},t}var tn=function(){var c=!1;if(typeof window<"u"&&typeof window.document<"u")try{var t=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));t.terminate(),c=!0}catch(v){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+v.message+"]")}return tn=function(){return c},c},Ln=0,On=0,it=!1,yr=Object.create(null),br=Object.create(null),lt=Object.create(null);function or(c){if((!c||typeof c.init!="function")&&!it)throw new Error("requires `options.init` function");var t=c.dependencies,v=c.init,h=c.getTransferables,r=c.workerId,e=Rn(c);r==null&&(r="#default");var a="workerModule"+ ++Ln,i=c.name||a,n=null;t=t&&t.map(function(s){return typeof s=="function"&&!s.workerModuleData&&(it=!0,s=or({workerId:r,name:"<"+i+"> function dependency: "+s.name,init:`function(){return (
`+Lr(s)+`
)}`}),it=!1),s&&s.workerModuleData&&(s=s.workerModuleData),s});function o(){for(var s=[],l=arguments.length;l--;)s[l]=arguments[l];if(!tn())return e.apply(void 0,s);if(!n){n=Wt(r,"registerModule",o.workerModuleData);var f=function(){n=null,br[r].delete(f)};(br[r]||(br[r]=new Set)).add(f)}return n.then(function(u){var p=u.isCallable;if(p)return Wt(r,"callModule",{id:a,args:s});throw new Error("Worker module function was called but `init` did not return a callable function")})}return o.workerModuleData={isWorkerModule:!0,id:a,name:i,dependencies:t,init:Lr(v),getTransferables:h&&Lr(h)},o.onMainThread=e,o}function Bn(c){br[c]&&br[c].forEach(function(t){t()}),yr[c]&&(yr[c].terminate(),delete yr[c])}function Lr(c){var t=c.toString();return!/^function/.test(t)&&/^\w+\s*\(/.test(t)&&(t="function "+t),t}function Pn(c){var t=yr[c];if(!t){var v=Lr(Gn);t=yr[c]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+c.replace(/\*/g,"")+` **/

;(`+v+")()"],{type:"application/javascript"}))),t.onmessage=function(h){var r=h.data,e=r.messageId,a=lt[e];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete lt[e],a(r)}}return t}function Wt(c,t,v){return new Promise(function(h,r){var e=++On;lt[e]=function(a){a.success?h(a.result):r(new Error("Error in worker "+t+" call: "+a.error))},Pn(c).postMessage({messageId:e,action:t,data:v})})}function nn(){var c=function(t){function v(B,G,d,b,k,A,_,N){var E=1-_;N.x=E*E*B+2*E*_*d+_*_*k,N.y=E*E*G+2*E*_*b+_*_*A}function h(B,G,d,b,k,A,_,N,E,P){var H=1-E;P.x=H*H*H*B+3*H*H*E*d+3*H*E*E*k+E*E*E*_,P.y=H*H*H*G+3*H*H*E*b+3*H*E*E*A+E*E*E*N}function r(B,G){for(var d=/([MLQCZ])([^MLQCZ]*)/g,b,k,A,_,N;b=d.exec(B);){var E=b[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(P){return parseFloat(P)});switch(b[1]){case"M":_=k=E[0],N=A=E[1];break;case"L":(E[0]!==_||E[1]!==N)&&G("L",_,N,_=E[0],N=E[1]);break;case"Q":{G("Q",_,N,_=E[2],N=E[3],E[0],E[1]);break}case"C":{G("C",_,N,_=E[4],N=E[5],E[0],E[1],E[2],E[3]);break}case"Z":(_!==k||N!==A)&&G("L",_,N,k,A);break}}}function e(B,G,d){d===void 0&&(d=16);var b={x:0,y:0};r(B,function(k,A,_,N,E,P,H,$,V){switch(k){case"L":G(A,_,N,E);break;case"Q":{for(var W=A,pe=_,ue=1;ue<d;ue++)v(A,_,P,H,N,E,ue/(d-1),b),G(W,pe,b.x,b.y),W=b.x,pe=b.y;break}case"C":{for(var Q=A,ee=_,se=1;se<d;se++)h(A,_,P,H,$,V,N,E,se/(d-1),b),G(Q,ee,b.x,b.y),Q=b.x,ee=b.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",i="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,o={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(B,G){var d=B.getContext?B.getContext("webgl",o):B,b=n.get(d);if(!b){let H=function(Q){var ee=A[Q];if(!ee&&(ee=A[Q]=d.getExtension(Q),!ee))throw new Error(Q+" not supported");return ee},$=function(Q,ee){var se=d.createShader(ee);return d.shaderSource(se,Q),d.compileShader(se),se},V=function(Q,ee,se,j){if(!_[Q]){var re={},q={},O=d.createProgram();d.attachShader(O,$(ee,d.VERTEX_SHADER)),d.attachShader(O,$(se,d.FRAGMENT_SHADER)),d.linkProgram(O),_[Q]={program:O,transaction:function(K){d.useProgram(O),K({setUniform:function(Y,be){for(var ne=[],oe=arguments.length-2;oe-- >0;)ne[oe]=arguments[oe+2];var le=q[be]||(q[be]=d.getUniformLocation(O,be));d["uniform"+Y].apply(d,[le].concat(ne))},setAttribute:function(Y,be,ne,oe,le){var de=re[Y];de||(de=re[Y]={buf:d.createBuffer(),loc:d.getAttribLocation(O,Y),data:null}),d.bindBuffer(d.ARRAY_BUFFER,de.buf),d.vertexAttribPointer(de.loc,be,d.FLOAT,!1,0,0),d.enableVertexAttribArray(de.loc),k?d.vertexAttribDivisor(de.loc,oe):H("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(de.loc,oe),le!==de.data&&(d.bufferData(d.ARRAY_BUFFER,le,ne),de.data=le)}})}}}_[Q].transaction(j)},W=function(Q,ee){E++;try{d.activeTexture(d.TEXTURE0+E);var se=N[Q];se||(se=N[Q]=d.createTexture(),d.bindTexture(d.TEXTURE_2D,se),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST)),d.bindTexture(d.TEXTURE_2D,se),ee(se,E)}finally{E--}},pe=function(Q,ee,se){var j=d.createFramebuffer();P.push(j),d.bindFramebuffer(d.FRAMEBUFFER,j),d.activeTexture(d.TEXTURE0+ee),d.bindTexture(d.TEXTURE_2D,Q),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,Q,0);try{se(j)}finally{d.deleteFramebuffer(j),d.bindFramebuffer(d.FRAMEBUFFER,P[--P.length-1]||null)}},ue=function(){A={},_={},N={},E=-1,P.length=0};var k=typeof WebGL2RenderingContext<"u"&&d instanceof WebGL2RenderingContext,A={},_={},N={},E=-1,P=[];d.canvas.addEventListener("webglcontextlost",function(Q){ue(),Q.preventDefault()},!1),n.set(d,b={gl:d,isWebGL2:k,getExtension:H,withProgram:V,withTexture:W,withTextureFramebuffer:pe,handleContextLoss:ue})}G(b)}function l(B,G,d,b,k,A,_,N){_===void 0&&(_=15),N===void 0&&(N=null),s(B,function(E){var P=E.gl,H=E.withProgram,$=E.withTexture;$("copy",function(V,W){P.texImage2D(P.TEXTURE_2D,0,P.RGBA,k,A,0,P.RGBA,P.UNSIGNED_BYTE,G),H("copy",a,i,function(pe){var ue=pe.setUniform,Q=pe.setAttribute;Q("aUV",2,P.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",W),P.bindFramebuffer(P.FRAMEBUFFER,N||null),P.disable(P.BLEND),P.colorMask(_&8,_&4,_&2,_&1),P.viewport(d,b,k,A),P.scissor(d,b,k,A),P.drawArrays(P.TRIANGLES,0,3)})})})}function f(B,G,d){var b=B.width,k=B.height;s(B,function(A){var _=A.gl,N=new Uint8Array(b*k*4);_.readPixels(0,0,b,k,_.RGBA,_.UNSIGNED_BYTE,N),B.width=G,B.height=d,l(_,N,0,0,b,k)})}var u=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:l,resizeWebGLCanvasWithoutClearing:f});function p(B,G,d,b,k,A){A===void 0&&(A=1);var _=new Uint8Array(B*G),N=b[2]-b[0],E=b[3]-b[1],P=[];e(d,function(Q,ee,se,j){P.push({x1:Q,y1:ee,x2:se,y2:j,minX:Math.min(Q,se),minY:Math.min(ee,j),maxX:Math.max(Q,se),maxY:Math.max(ee,j)})}),P.sort(function(Q,ee){return Q.maxX-ee.maxX});for(var H=0;H<B;H++)for(var $=0;$<G;$++){var V=pe(b[0]+N*(H+.5)/B,b[1]+E*($+.5)/G),W=Math.pow(1-Math.abs(V)/k,A)/2;V<0&&(W=1-W),W=Math.max(0,Math.min(255,Math.round(W*255))),_[$*B+H]=W}return _;function pe(Q,ee){for(var se=1/0,j=1/0,re=P.length;re--;){var q=P[re];if(q.maxX+j<=Q)break;if(Q+j>q.minX&&ee-j<q.maxY&&ee+j>q.minY){var O=L(Q,ee,q.x1,q.y1,q.x2,q.y2);O<se&&(se=O,j=Math.sqrt(se))}}return ue(Q,ee)&&(j=-j),j}function ue(Q,ee){for(var se=0,j=P.length;j--;){var re=P[j];if(re.maxX<=Q)break;var q=re.y1>ee!=re.y2>ee&&Q<(re.x2-re.x1)*(ee-re.y1)/(re.y2-re.y1)+re.x1;q&&(se+=re.y1<re.y2?1:-1)}return se!==0}}function g(B,G,d,b,k,A,_,N,E,P){A===void 0&&(A=1),N===void 0&&(N=0),E===void 0&&(E=0),P===void 0&&(P=0),y(B,G,d,b,k,A,_,null,N,E,P)}function y(B,G,d,b,k,A,_,N,E,P,H){A===void 0&&(A=1),E===void 0&&(E=0),P===void 0&&(P=0),H===void 0&&(H=0);for(var $=p(B,G,d,b,k,A),V=new Uint8Array($.length*4),W=0;W<$.length;W++)V[W*4+H]=$[W];l(_,V,E,P,B,G,1<<3-H,N)}function L(B,G,d,b,k,A){var _=k-d,N=A-b,E=_*_+N*N,P=E?Math.max(0,Math.min(1,((B-d)*_+(G-b)*N)/E)):0,H=B-(d+P*_),$=G-(b+P*N);return H*H+$*$}var x=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:g,generateIntoFramebuffer:y}),F="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",U="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",T="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",R=new Float32Array([0,0,2,0,0,2]),S=null,C=!1,I={},M=new WeakMap;function J(B){if(!C&&!X(B))throw new Error("WebGL generation not supported")}function m(B,G,d,b,k,A,_){if(A===void 0&&(A=1),_===void 0&&(_=null),!_&&(_=S,!_)){var N=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!N)throw new Error("OffscreenCanvas or DOM canvas not supported");_=S=N.getContext("webgl",{depth:!1})}J(_);var E=new Uint8Array(B*G*4);s(_,function(V){var W=V.gl,pe=V.withTexture,ue=V.withTextureFramebuffer;pe("readable",function(Q,ee){W.texImage2D(W.TEXTURE_2D,0,W.RGBA,B,G,0,W.RGBA,W.UNSIGNED_BYTE,null),ue(Q,ee,function(se){w(B,G,d,b,k,A,W,se,0,0,0),W.readPixels(0,0,B,G,W.RGBA,W.UNSIGNED_BYTE,E)})})});for(var P=new Uint8Array(B*G),H=0,$=0;H<E.length;H+=4)P[$++]=E[H];return P}function D(B,G,d,b,k,A,_,N,E,P){A===void 0&&(A=1),N===void 0&&(N=0),E===void 0&&(E=0),P===void 0&&(P=0),w(B,G,d,b,k,A,_,null,N,E,P)}function w(B,G,d,b,k,A,_,N,E,P,H){A===void 0&&(A=1),E===void 0&&(E=0),P===void 0&&(P=0),H===void 0&&(H=0),J(_);var $=[];e(d,function(V,W,pe,ue){$.push(V,W,pe,ue)}),$=new Float32Array($),s(_,function(V){var W=V.gl,pe=V.isWebGL2,ue=V.getExtension,Q=V.withProgram,ee=V.withTexture,se=V.withTextureFramebuffer,j=V.handleContextLoss;if(ee("rawDistances",function(re,q){(B!==re._lastWidth||G!==re._lastHeight)&&W.texImage2D(W.TEXTURE_2D,0,W.RGBA,re._lastWidth=B,re._lastHeight=G,0,W.RGBA,W.UNSIGNED_BYTE,null),Q("main",F,U,function(O){var he=O.setAttribute,K=O.setUniform,ae=!pe&&ue("ANGLE_instanced_arrays"),Y=!pe&&ue("EXT_blend_minmax");he("aUV",2,W.STATIC_DRAW,0,R),he("aLineSegment",4,W.DYNAMIC_DRAW,1,$),K.apply(void 0,["4f","uGlyphBounds"].concat(b)),K("1f","uMaxDistance",k),K("1f","uExponent",A),se(re,q,function(be){W.enable(W.BLEND),W.colorMask(!0,!0,!0,!0),W.viewport(0,0,B,G),W.scissor(0,0,B,G),W.blendFunc(W.ONE,W.ONE),W.blendEquationSeparate(W.FUNC_ADD,pe?W.MAX:Y.MAX_EXT),W.clear(W.COLOR_BUFFER_BIT),pe?W.drawArraysInstanced(W.TRIANGLES,0,3,$.length/4):ae.drawArraysInstancedANGLE(W.TRIANGLES,0,3,$.length/4)})}),Q("post",a,T,function(O){O.setAttribute("aUV",2,W.STATIC_DRAW,0,R),O.setUniform("1i","tex",q),W.bindFramebuffer(W.FRAMEBUFFER,N),W.disable(W.BLEND),W.colorMask(H===0,H===1,H===2,H===3),W.viewport(E,P,B,G),W.scissor(E,P,B,G),W.drawArrays(W.TRIANGLES,0,3)})}),W.isContextLost())throw j(),new Error("webgl context lost")})}function X(B){var G=!B||B===S?I:B.canvas||B,d=M.get(G);if(d===void 0){C=!0;var b=null;try{var k=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],A=m(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,B);d=A&&k.length===A.length&&A.every(function(_,N){return _===k[N]}),d||(b="bad trial run results",console.info(k,A))}catch(_){d=!1,b=_.message}b&&console.warn("WebGL SDF generation not supported:",b),C=!1,M.set(G,d)}return d}var z=Object.freeze({__proto__:null,generate:m,generateIntoCanvas:D,generateIntoFramebuffer:w,isSupported:X});function Z(B,G,d,b,k,A){k===void 0&&(k=Math.max(b[2]-b[0],b[3]-b[1])/2),A===void 0&&(A=1);try{return m.apply(z,arguments)}catch(_){return console.info("WebGL SDF generation failed, falling back to JS",_),p.apply(x,arguments)}}function te(B,G,d,b,k,A,_,N,E,P){k===void 0&&(k=Math.max(b[2]-b[0],b[3]-b[1])/2),A===void 0&&(A=1),N===void 0&&(N=0),E===void 0&&(E=0),P===void 0&&(P=0);try{return D.apply(z,arguments)}catch(H){return console.info("WebGL SDF generation failed, falling back to JS",H),g.apply(x,arguments)}}return t.forEachPathCommand=r,t.generate=Z,t.generateIntoCanvas=te,t.javascript=x,t.pathToLineSegments=e,t.webgl=z,t.webglUtils=u,Object.defineProperty(t,"__esModule",{value:!0}),t}({});return c}function In(){var c=function(t){var v={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},h={},r={};h.L=1,r[1]="L",Object.keys(v).forEach(function(j,re){h[j]=1<<re+1,r[h[j]]=j}),Object.freeze(h);var e=h.LRI|h.RLI|h.FSI,a=h.L|h.R|h.AL,i=h.B|h.S|h.WS|h.ON|h.FSI|h.LRI|h.RLI|h.PDI,n=h.BN|h.RLE|h.LRE|h.RLO|h.LRO|h.PDF,o=h.S|h.WS|h.B|e|h.PDI|n,s=null;function l(){if(!s){s=new Map;var j=function(q){if(v.hasOwnProperty(q)){var O=0;v[q].split(",").forEach(function(he){var K=he.split("+"),ae=K[0],Y=K[1];ae=parseInt(ae,36),Y=Y?parseInt(Y,36):0,s.set(O+=ae,h[q]);for(var be=0;be<Y;be++)s.set(++O,h[q])})}};for(var re in v)j(re)}}function f(j){return l(),s.get(j.codePointAt(0))||h.L}function u(j){return r[f(j)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(j,re){var q=36,O=0,he=new Map,K=re&&new Map,ae;return j.split(",").forEach(function Y(be){if(be.indexOf("+")!==-1)for(var ne=+be;ne--;)Y(ae);else{ae=be;var oe=be.split(">"),le=oe[0],de=oe[1];le=String.fromCodePoint(O+=parseInt(le,q)),de=String.fromCodePoint(O+=parseInt(de,q)),he.set(le,de),re&&K.set(de,le)}}),{map:he,reverseMap:K}}var y,L,x;function F(){if(!y){var j=g(p.pairs,!0),re=j.map,q=j.reverseMap;y=re,L=q,x=g(p.canonical,!1).map}}function U(j){return F(),y.get(j)||null}function T(j){return F(),L.get(j)||null}function R(j){return F(),x.get(j)||null}var S=h.L,C=h.R,I=h.EN,M=h.ES,J=h.ET,m=h.AN,D=h.CS,w=h.B,X=h.S,z=h.ON,Z=h.BN,te=h.NSM,B=h.AL,G=h.LRO,d=h.RLO,b=h.LRE,k=h.RLE,A=h.PDF,_=h.LRI,N=h.RLI,E=h.FSI,P=h.PDI;function H(j,re){for(var q=125,O=new Uint32Array(j.length),he=0;he<j.length;he++)O[he]=f(j[he]);var K=new Map;function ae(Oe,We){var Be=O[Oe];O[Oe]=We,K.set(Be,K.get(Be)-1),Be&i&&K.set(i,K.get(i)-1),K.set(We,(K.get(We)||0)+1),We&i&&K.set(i,(K.get(i)||0)+1)}for(var Y=new Uint8Array(j.length),be=new Map,ne=[],oe=null,le=0;le<j.length;le++)oe||ne.push(oe={start:le,end:j.length-1,level:re==="rtl"?1:re==="ltr"?0:Bt(le,!1)}),O[le]&w&&(oe.end=le,oe=null);for(var de=k|b|d|G|e|P|A|w,Se=function(Oe){return Oe+(Oe&1?1:2)},Fe=function(Oe){return Oe+(Oe&1?2:1)},ge=0;ge<ne.length;ge++){oe=ne[ge];var me=[{_level:oe.level,_override:0,_isolate:0}],fe=void 0,Ce=0,ke=0,Le=0;K.clear();for(var xe=oe.start;xe<=oe.end;xe++){var ce=O[xe];if(fe=me[me.length-1],K.set(ce,(K.get(ce)||0)+1),ce&i&&K.set(i,(K.get(i)||0)+1),ce&de)if(ce&(k|b)){Y[xe]=fe._level;var Ue=(ce===k?Fe:Se)(fe._level);Ue<=q&&!Ce&&!ke?me.push({_level:Ue,_override:0,_isolate:0}):Ce||ke++}else if(ce&(d|G)){Y[xe]=fe._level;var Xe=(ce===d?Fe:Se)(fe._level);Xe<=q&&!Ce&&!ke?me.push({_level:Xe,_override:ce&d?C:S,_isolate:0}):Ce||ke++}else if(ce&e){ce&E&&(ce=Bt(xe+1,!0)===1?N:_),Y[xe]=fe._level,fe._override&&ae(xe,fe._override);var _e=(ce===N?Fe:Se)(fe._level);_e<=q&&Ce===0&&ke===0?(Le++,me.push({_level:_e,_override:0,_isolate:1,_isolInitIndex:xe})):Ce++}else if(ce&P){if(Ce>0)Ce--;else if(Le>0){for(ke=0;!me[me.length-1]._isolate;)me.pop();var ye=me[me.length-1]._isolInitIndex;ye!=null&&(be.set(ye,xe),be.set(xe,ye)),me.pop(),Le--}fe=me[me.length-1],Y[xe]=fe._level,fe._override&&ae(xe,fe._override)}else ce&A?(Ce===0&&(ke>0?ke--:!fe._isolate&&me.length>1&&(me.pop(),fe=me[me.length-1])),Y[xe]=fe._level):ce&w&&(Y[xe]=oe.level);else Y[xe]=fe._level,fe._override&&ce!==Z&&ae(xe,fe._override)}for(var Ae=[],Te=null,ve=oe.start;ve<=oe.end;ve++){var we=O[ve];if(!(we&n)){var Ge=Y[ve],Me=we&e,De=we===P;Te&&Ge===Te._level?(Te._end=ve,Te._endsWithIsolInit=Me):Ae.push(Te={_start:ve,_end:ve,_level:Ge,_startsWithPDI:De,_endsWithIsolInit:Me})}}for(var Ie=[],He=0;He<Ae.length;He++){var je=Ae[He];if(!je._startsWithPDI||je._startsWithPDI&&!be.has(je._start)){for(var Ye=[Te=je],Qe=void 0;Te&&Te._endsWithIsolInit&&(Qe=be.get(Te._end))!=null;)for(var Ve=He+1;Ve<Ae.length;Ve++)if(Ae[Ve]._start===Qe){Ye.push(Te=Ae[Ve]);break}for(var Re=[],Ze=0;Ze<Ye.length;Ze++)for(var mt=Ye[Ze],Nr=mt._start;Nr<=mt._end;Nr++)Re.push(Nr);for(var vn=Y[Re[0]],yt=oe.level,Ur=Re[0]-1;Ur>=0;Ur--)if(!(O[Ur]&n)){yt=Y[Ur];break}var Wr=Re[Re.length-1],pn=Y[Wr],bt=oe.level;if(!(O[Wr]&e)){for(var _r=Wr+1;_r<=oe.end;_r++)if(!(O[_r]&n)){bt=Y[_r];break}}Ie.push({_seqIndices:Re,_sosType:Math.max(yt,vn)%2?C:S,_eosType:Math.max(bt,pn)%2?C:S})}}for(var zr=0;zr<Ie.length;zr++){var jr=Ie[zr],ie=jr._seqIndices,ir=jr._sosType,gn=jr._eosType,er=Y[ie[0]]&1?C:S;if(K.get(te))for(var Sr=0;Sr<ie.length;Sr++){var Ut=ie[Sr];if(O[Ut]&te){for(var Vr=ir,xr=Sr-1;xr>=0;xr--)if(!(O[ie[xr]]&n)){Vr=O[ie[xr]];break}ae(Ut,Vr&(e|P)?z:Vr)}}if(K.get(I))for(var kr=0;kr<ie.length;kr++){var _t=ie[kr];if(O[_t]&I)for(var Tr=kr-1;Tr>=-1;Tr--){var St=Tr===-1?ir:O[ie[Tr]];if(St&a){St===B&&ae(_t,m);break}}}if(K.get(B))for(var Xr=0;Xr<ie.length;Xr++){var xt=ie[Xr];O[xt]&B&&ae(xt,C)}if(K.get(M)||K.get(D))for(var sr=1;sr<ie.length-1;sr++){var Hr=ie[sr];if(O[Hr]&(M|D)){for(var rr=0,Yr=0,Jr=sr-1;Jr>=0&&(rr=O[ie[Jr]],!!(rr&n));Jr--);for(var Kr=sr+1;Kr<ie.length&&(Yr=O[ie[Kr]],!!(Yr&n));Kr++);rr===Yr&&(O[Hr]===M?rr===I:rr&(I|m))&&ae(Hr,rr)}}if(K.get(I))for(var ze=0;ze<ie.length;ze++){var mn=ie[ze];if(O[mn]&I){for(var wr=ze-1;wr>=0&&O[ie[wr]]&(J|n);wr--)ae(ie[wr],I);for(ze++;ze<ie.length&&O[ie[ze]]&(J|n|I);ze++)O[ie[ze]]!==I&&ae(ie[ze],I)}}if(K.get(J)||K.get(M)||K.get(D))for(var fr=0;fr<ie.length;fr++){var kt=ie[fr];if(O[kt]&(J|M|D)){ae(kt,z);for(var Fr=fr-1;Fr>=0&&O[ie[Fr]]&n;Fr--)ae(ie[Fr],z);for(var Cr=fr+1;Cr<ie.length&&O[ie[Cr]]&n;Cr++)ae(ie[Cr],z)}}if(K.get(I))for(var Qr=0,Tt=ir;Qr<ie.length;Qr++){var wt=ie[Qr],Zr=O[wt];Zr&I?Tt===S&&ae(wt,S):Zr&a&&(Tt=Zr)}if(K.get(i)){var lr=C|I|m,Ft=lr|S,Ar=[];{for(var tr=[],nr=0;nr<ie.length;nr++)if(O[ie[nr]]&i){var ur=j[ie[nr]],Ct=void 0;if(U(ur)!==null)if(tr.length<63)tr.push({char:ur,seqIndex:nr});else break;else if((Ct=T(ur))!==null)for(var cr=tr.length-1;cr>=0;cr--){var qr=tr[cr].char;if(qr===Ct||qr===T(R(ur))||U(R(qr))===ur){Ar.push([tr[cr].seqIndex,nr]),tr.length=cr;break}}}Ar.sort(function(Oe,We){return Oe[0]-We[0]})}for(var $r=0;$r<Ar.length;$r++){for(var At=Ar[$r],Dr=At[0],et=At[1],Dt=!1,Ne=0,rt=Dr+1;rt<et;rt++){var Et=ie[rt];if(O[Et]&Ft){Dt=!0;var Mt=O[Et]&lr?C:S;if(Mt===er){Ne=Mt;break}}}if(Dt&&!Ne){Ne=ir;for(var tt=Dr-1;tt>=0;tt--){var Gt=ie[tt];if(O[Gt]&Ft){var Rt=O[Gt]&lr?C:S;Rt!==er?Ne=Rt:Ne=er;break}}}if(Ne){if(O[ie[Dr]]=O[ie[et]]=Ne,Ne!==er){for(var hr=Dr+1;hr<ie.length;hr++)if(!(O[ie[hr]]&n)){f(j[ie[hr]])&te&&(O[ie[hr]]=Ne);break}}if(Ne!==er){for(var dr=et+1;dr<ie.length;dr++)if(!(O[ie[dr]]&n)){f(j[ie[dr]])&te&&(O[ie[dr]]=Ne);break}}}}for(var Je=0;Je<ie.length;Je++)if(O[ie[Je]]&i){for(var Lt=Je,nt=Je,at=ir,vr=Je-1;vr>=0;vr--)if(O[ie[vr]]&n)Lt=vr;else{at=O[ie[vr]]&lr?C:S;break}for(var Ot=gn,pr=Je+1;pr<ie.length;pr++)if(O[ie[pr]]&(i|n))nt=pr;else{Ot=O[ie[pr]]&lr?C:S;break}for(var ot=Lt;ot<=nt;ot++)O[ie[ot]]=at===Ot?at:er;Je=nt}}}for(var Pe=oe.start;Pe<=oe.end;Pe++){var yn=Y[Pe],Er=O[Pe];if(yn&1?Er&(S|I|m)&&Y[Pe]++:Er&C?Y[Pe]++:Er&(m|I)&&(Y[Pe]+=2),Er&n&&(Y[Pe]=Pe===0?oe.level:Y[Pe-1]),Pe===oe.end||f(j[Pe])&(X|w))for(var Mr=Pe;Mr>=0&&f(j[Mr])&o;Mr--)Y[Mr]=oe.level}}return{levels:Y,paragraphs:ne};function Bt(Oe,We){for(var Be=Oe;Be<j.length;Be++){var Ke=O[Be];if(Ke&(C|B))return 1;if(Ke&(w|S)||We&&Ke===P)return 0;if(Ke&e){var Pt=bn(Be);Be=Pt===-1?j.length:Pt}}return 0}function bn(Oe){for(var We=1,Be=Oe+1;Be<j.length;Be++){var Ke=O[Be];if(Ke&w)break;if(Ke&P){if(--We===0)return Be}else Ke&e&&We++}return-1}}var $="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",V;function W(){if(!V){var j=g($,!0),re=j.map,q=j.reverseMap;q.forEach(function(O,he){re.set(he,O)}),V=re}}function pe(j){return W(),V.get(j)||null}function ue(j,re,q,O){var he=j.length;q=Math.max(0,q==null?0:+q),O=Math.min(he-1,O==null?he-1:+O);for(var K=new Map,ae=q;ae<=O;ae++)if(re[ae]&1){var Y=pe(j[ae]);Y!==null&&K.set(ae,Y)}return K}function Q(j,re,q,O){var he=j.length;q=Math.max(0,q==null?0:+q),O=Math.min(he-1,O==null?he-1:+O);var K=[];return re.paragraphs.forEach(function(ae){var Y=Math.max(q,ae.start),be=Math.min(O,ae.end);if(Y<be){for(var ne=re.levels.slice(Y,be+1),oe=be;oe>=Y&&f(j[oe])&o;oe--)ne[oe]=ae.level;for(var le=ae.level,de=1/0,Se=0;Se<ne.length;Se++){var Fe=ne[Se];Fe>le&&(le=Fe),Fe<de&&(de=Fe|1)}for(var ge=le;ge>=de;ge--)for(var me=0;me<ne.length;me++)if(ne[me]>=ge){for(var fe=me;me+1<ne.length&&ne[me+1]>=ge;)me++;me>fe&&K.push([fe+Y,me+Y])}}}),K}function ee(j,re,q,O){var he=se(j,re,q,O),K=[].concat(j);return he.forEach(function(ae,Y){K[Y]=(re.levels[ae]&1?pe(j[ae]):null)||j[ae]}),K.join("")}function se(j,re,q,O){for(var he=Q(j,re,q,O),K=[],ae=0;ae<j.length;ae++)K[ae]=ae;return he.forEach(function(Y){for(var be=Y[0],ne=Y[1],oe=K.slice(be,ne+1),le=oe.length;le--;)K[ne-le]=oe[le]}),K}return t.closingToOpeningBracket=T,t.getBidiCharType=f,t.getBidiCharTypeName=u,t.getCanonicalBracket=R,t.getEmbeddingLevels=H,t.getMirroredCharacter=pe,t.getMirroredCharactersMap=ue,t.getReorderSegments=Q,t.getReorderedIndices=se,t.getReorderedString=ee,t.openingToClosingBracket=U,Object.defineProperty(t,"__esModule",{value:!0}),t}({});return c}const an=/\bvoid\s+main\s*\(\s*\)\s*{/g;function ut(c){const t=/^[ \t]*#include +<([\w\d./]+)>/gm;function v(h,r){let e=kn[r];return e?ut(e):h}return c.replace(t,v)}const Ee=[];for(let c=0;c<256;c++)Ee[c]=(c<16?"0":"")+c.toString(16);function Nn(){const c=Math.random()*4294967295|0,t=Math.random()*4294967295|0,v=Math.random()*4294967295|0,h=Math.random()*4294967295|0;return(Ee[c&255]+Ee[c>>8&255]+Ee[c>>16&255]+Ee[c>>24&255]+"-"+Ee[t&255]+Ee[t>>8&255]+"-"+Ee[t>>16&15|64]+Ee[t>>24&255]+"-"+Ee[v&63|128]+Ee[v>>8&255]+"-"+Ee[v>>16&255]+Ee[v>>24&255]+Ee[h&255]+Ee[h>>8&255]+Ee[h>>16&255]+Ee[h>>24&255]).toUpperCase()}const qe=Object.assign||function(){let c=arguments[0];for(let t=1,v=arguments.length;t<v;t++){let h=arguments[t];if(h)for(let r in h)Object.prototype.hasOwnProperty.call(h,r)&&(c[r]=h[r])}return c},Wn=Date.now(),zt=new WeakMap,jt=new Map;let zn=1e10;function ct(c,t){const v=Hn(t);let h=zt.get(c);if(h||zt.set(c,h=Object.create(null)),h[v])return new h[v];const r=`_onBeforeCompile${v}`,e=function(o,s){c.onBeforeCompile.call(this,o,s);const l=this.customProgramCacheKey()+"|"+o.vertexShader+"|"+o.fragmentShader;let f=jt[l];if(!f){const u=jn(this,o,t,v);f=jt[l]=u}o.vertexShader=f.vertexShader,o.fragmentShader=f.fragmentShader,qe(o.uniforms,this.uniforms),t.timeUniform&&(o.uniforms[t.timeUniform]={get value(){return Date.now()-Wn}}),this[r]&&this[r](o)},a=function(){return i(t.chained?c:c.clone())},i=function(o){const s=Object.create(o,n);return Object.defineProperty(s,"baseMaterial",{value:c}),Object.defineProperty(s,"id",{value:zn++}),s.uuid=Nn(),s.uniforms=qe({},o.uniforms,t.uniforms),s.defines=qe({},o.defines,t.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${v}`]="",s.extensions=qe({},o.extensions,t.extensions),s._listeners=void 0,s},n={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>c.type,set:o=>{c.type=o}},isDerivedFrom:{writable:!0,configurable:!0,value:function(o){const s=this.baseMaterial;return o===s||s.isDerivedMaterial&&s.isDerivedFrom(o)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return c.customProgramCacheKey()+"|"+v}},onBeforeCompile:{get(){return e},set(o){this[r]=o}},copy:{writable:!0,configurable:!0,value:function(o){return c.copy.call(this,o),!c.isShaderMaterial&&!c.isDerivedMaterial&&(qe(this.extensions,o.extensions),qe(this.defines,o.defines),qe(this.uniforms,xn.clone(o.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const o=new c.constructor;return i(o).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let o=this._depthMaterial;return o||(o=this._depthMaterial=ct(c.isDerivedMaterial?c.getDepthMaterial():new _n({depthPacking:Sn}),t),o.defines.IS_DEPTH_MATERIAL="",o.uniforms=this.uniforms),o}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let o=this._distanceMaterial;return o||(o=this._distanceMaterial=ct(c.isDerivedMaterial?c.getDistanceMaterial():new Un,t),o.defines.IS_DISTANCE_MATERIAL="",o.uniforms=this.uniforms),o}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:o,_distanceMaterial:s}=this;o&&o.dispose(),s&&s.dispose(),c.dispose.call(this)}}};return h[v]=a,new a}function jn(c,{vertexShader:t,fragmentShader:v},h,r){let{vertexDefs:e,vertexMainIntro:a,vertexMainOutro:i,vertexTransform:n,fragmentDefs:o,fragmentMainIntro:s,fragmentMainOutro:l,fragmentColorTransform:f,customRewriter:u,timeUniform:p}=h;if(e=e||"",a=a||"",i=i||"",o=o||"",s=s||"",l=l||"",(n||u)&&(t=ut(t)),(f||u)&&(v=v.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),v=ut(v)),u){let g=u({vertexShader:t,fragmentShader:v});t=g.vertexShader,v=g.fragmentShader}if(f){let g=[];v=v.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(g.push(y),"")),l=`${f}
${g.join(`
`)}
${l}`}if(p){const g=`
uniform float ${p};
`;e=g+e,o=g+o}return n&&(t=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${t}
`,e=`${e}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${n}
}
`,a=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${a}
`,t=t.replace(/\b(position|normal|uv)\b/g,(g,y,L,x)=>/\battribute\s+vec[23]\s+$/.test(x.substr(0,L))?y:`troika_${y}_${r}`),c.map&&c.map.channel>0||(t=t.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),t=Vt(t,r,e,a,i),v=Vt(v,r,o,s,l),{vertexShader:t,fragmentShader:v}}function Vt(c,t,v,h,r){return(h||r||v)&&(c=c.replace(an,`
${v}
void troikaOrigMain${t}() {`),c+=`
void main() {
  ${h}
  troikaOrigMain${t}();
  ${r}
}`),c}function Vn(c,t){return c==="uniforms"?void 0:typeof t=="function"?t.toString():t}let Xn=0;const Xt=new Map;function Hn(c){const t=JSON.stringify(c,Vn);let v=Xt.get(t);return v==null&&Xt.set(t,v=++Xn),v}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Yn(){return typeof window>"u"&&(self.window=self),function(c){var t={parse:function(r){var e=t._bin,a=new Uint8Array(r);if(e.readASCII(a,0,4)=="ttcf"){var i=4;e.readUshort(a,i),i+=2,e.readUshort(a,i),i+=2;var n=e.readUint(a,i);i+=4;for(var o=[],s=0;s<n;s++){var l=e.readUint(a,i);i+=4,o.push(t._readFont(a,l))}return o}return[t._readFont(a,0)]},_readFont:function(r,e){var a=t._bin,i=e;a.readFixed(r,e),e+=4;var n=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],s={_data:r,_offset:i},l={},f=0;f<n;f++){var u=a.readASCII(r,e,4);e+=4,a.readUint(r,e),e+=4;var p=a.readUint(r,e);e+=4;var g=a.readUint(r,e);e+=4,l[u]={offset:p,length:g}}for(f=0;f<o.length;f++){var y=o[f];l[y]&&(s[y.trim()]=t[y.trim()].parse(r,l[y].offset,l[y].length,s))}return s},_tabOffset:function(r,e,a){for(var i=t._bin,n=i.readUshort(r,a+4),o=a+12,s=0;s<n;s++){var l=i.readASCII(r,o,4);o+=4,i.readUint(r,o),o+=4;var f=i.readUint(r,o);if(o+=4,i.readUint(r,o),o+=4,l==e)return f}return 0}};t._bin={readFixed:function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<8|r[e+3])/65540},readF2dot14:function(r,e){return t._bin.readShort(r,e)/16384},readInt:function(r,e){return t._bin._view(r).getInt32(e)},readInt8:function(r,e){return t._bin._view(r).getInt8(e)},readShort:function(r,e){return t._bin._view(r).getInt16(e)},readUshort:function(r,e){return t._bin._view(r).getUint16(e)},readUshorts:function(r,e,a){for(var i=[],n=0;n<a;n++)i.push(t._bin.readUshort(r,e+2*n));return i},readUint:function(r,e){return t._bin._view(r).getUint32(e)},readUint64:function(r,e){return 4294967296*t._bin.readUint(r,e)+t._bin.readUint(r,e+4)},readASCII:function(r,e,a){for(var i="",n=0;n<a;n++)i+=String.fromCharCode(r[e+n]);return i},readUnicode:function(r,e,a){for(var i="",n=0;n<a;n++){var o=r[e++]<<8|r[e++];i+=String.fromCharCode(o)}return i},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,e,a){var i=t._bin._tdec;return i&&e==0&&a==r.length?i.decode(r):t._bin.readASCII(r,e,a)},readBytes:function(r,e,a){for(var i=[],n=0;n<a;n++)i.push(r[e+n]);return i},readASCIIArray:function(r,e,a){for(var i=[],n=0;n<a;n++)i.push(String.fromCharCode(r[e+n]));return i},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},t._lctf={},t._lctf.parse=function(r,e,a,i,n){var o=t._bin,s={},l=e;o.readFixed(r,e),e+=4;var f=o.readUshort(r,e);e+=2;var u=o.readUshort(r,e);e+=2;var p=o.readUshort(r,e);return e+=2,s.scriptList=t._lctf.readScriptList(r,l+f),s.featureList=t._lctf.readFeatureList(r,l+u),s.lookupList=t._lctf.readLookupList(r,l+p,n),s},t._lctf.readLookupList=function(r,e,a){var i=t._bin,n=e,o=[],s=i.readUshort(r,e);e+=2;for(var l=0;l<s;l++){var f=i.readUshort(r,e);e+=2;var u=t._lctf.readLookupTable(r,n+f,a);o.push(u)}return o},t._lctf.readLookupTable=function(r,e,a){var i=t._bin,n=e,o={tabs:[]};o.ltype=i.readUshort(r,e),e+=2,o.flag=i.readUshort(r,e),e+=2;var s=i.readUshort(r,e);e+=2;for(var l=o.ltype,f=0;f<s;f++){var u=i.readUshort(r,e);e+=2;var p=a(r,l,n+u,o);o.tabs.push(p)}return o},t._lctf.numOfOnes=function(r){for(var e=0,a=0;a<32;a++)(r>>>a&1)!=0&&e++;return e},t._lctf.readClassDef=function(r,e){var a=t._bin,i=[],n=a.readUshort(r,e);if(e+=2,n==1){var o=a.readUshort(r,e);e+=2;var s=a.readUshort(r,e);e+=2;for(var l=0;l<s;l++)i.push(o+l),i.push(o+l),i.push(a.readUshort(r,e)),e+=2}if(n==2){var f=a.readUshort(r,e);for(e+=2,l=0;l<f;l++)i.push(a.readUshort(r,e)),e+=2,i.push(a.readUshort(r,e)),e+=2,i.push(a.readUshort(r,e)),e+=2}return i},t._lctf.getInterval=function(r,e){for(var a=0;a<r.length;a+=3){var i=r[a],n=r[a+1];if(r[a+2],i<=e&&e<=n)return a}return-1},t._lctf.readCoverage=function(r,e){var a=t._bin,i={};i.fmt=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);return e+=2,i.fmt==1&&(i.tab=a.readUshorts(r,e,n)),i.fmt==2&&(i.tab=a.readUshorts(r,e,3*n)),i},t._lctf.coverageIndex=function(r,e){var a=r.tab;if(r.fmt==1)return a.indexOf(e);if(r.fmt==2){var i=t._lctf.getInterval(a,e);if(i!=-1)return a[i+2]+(e-a[i])}return-1},t._lctf.readFeatureList=function(r,e){var a=t._bin,i=e,n=[],o=a.readUshort(r,e);e+=2;for(var s=0;s<o;s++){var l=a.readASCII(r,e,4);e+=4;var f=a.readUshort(r,e);e+=2;var u=t._lctf.readFeatureTable(r,i+f);u.tag=l.trim(),n.push(u)}return n},t._lctf.readFeatureTable=function(r,e){var a=t._bin,i=e,n={},o=a.readUshort(r,e);e+=2,o>0&&(n.featureParams=i+o);var s=a.readUshort(r,e);e+=2,n.tab=[];for(var l=0;l<s;l++)n.tab.push(a.readUshort(r,e+2*l));return n},t._lctf.readScriptList=function(r,e){var a=t._bin,i=e,n={},o=a.readUshort(r,e);e+=2;for(var s=0;s<o;s++){var l=a.readASCII(r,e,4);e+=4;var f=a.readUshort(r,e);e+=2,n[l.trim()]=t._lctf.readScriptTable(r,i+f)}return n},t._lctf.readScriptTable=function(r,e){var a=t._bin,i=e,n={},o=a.readUshort(r,e);e+=2,o>0&&(n.default=t._lctf.readLangSysTable(r,i+o));var s=a.readUshort(r,e);e+=2;for(var l=0;l<s;l++){var f=a.readASCII(r,e,4);e+=4;var u=a.readUshort(r,e);e+=2,n[f.trim()]=t._lctf.readLangSysTable(r,i+u)}return n},t._lctf.readLangSysTable=function(r,e){var a=t._bin,i={};a.readUshort(r,e),e+=2,i.reqFeature=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);return e+=2,i.features=a.readUshorts(r,e,n),i},t.CFF={},t.CFF.parse=function(r,e,a){var i=t._bin;(r=new Uint8Array(r.buffer,e,a))[e=0],r[++e],r[++e],r[++e],e++;var n=[];e=t.CFF.readIndex(r,e,n);for(var o=[],s=0;s<n.length-1;s++)o.push(i.readASCII(r,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var l=[];e=t.CFF.readIndex(r,e,l);var f=[];for(s=0;s<l.length-1;s++)f.push(t.CFF.readDict(r,e+l[s],e+l[s+1]));e+=l[l.length-1];var u=f[0],p=[];e=t.CFF.readIndex(r,e,p);var g=[];for(s=0;s<p.length-1;s++)g.push(i.readASCII(r,e+p[s],p[s+1]-p[s]));if(e+=p[p.length-1],t.CFF.readSubrs(r,e,u),u.CharStrings){e=u.CharStrings,p=[],e=t.CFF.readIndex(r,e,p);var y=[];for(s=0;s<p.length-1;s++)y.push(i.readBytes(r,e+p[s],p[s+1]-p[s]));u.CharStrings=y}if(u.ROS){e=u.FDArray;var L=[];for(e=t.CFF.readIndex(r,e,L),u.FDArray=[],s=0;s<L.length-1;s++){var x=t.CFF.readDict(r,e+L[s],e+L[s+1]);t.CFF._readFDict(r,x,g),u.FDArray.push(x)}e+=L[L.length-1],e=u.FDSelect,u.FDSelect=[];var F=r[e];if(e++,F!=3)throw F;var U=i.readUshort(r,e);for(e+=2,s=0;s<U+1;s++)u.FDSelect.push(i.readUshort(r,e),r[e+2]),e+=3}return u.Encoding&&(u.Encoding=t.CFF.readEncoding(r,u.Encoding,u.CharStrings.length)),u.charset&&(u.charset=t.CFF.readCharset(r,u.charset,u.CharStrings.length)),t.CFF._readFDict(r,u,g),u},t.CFF._readFDict=function(r,e,a){var i;for(var n in e.Private&&(i=e.Private[1],e.Private=t.CFF.readDict(r,i,i+e.Private[0]),e.Private.Subrs&&t.CFF.readSubrs(r,i+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=a[e[n]-426+35])},t.CFF.readSubrs=function(r,e,a){var i=t._bin,n=[];e=t.CFF.readIndex(r,e,n);var o,s=n.length;o=s<1240?107:s<33900?1131:32768,a.Bias=o,a.Subrs=[];for(var l=0;l<n.length-1;l++)a.Subrs.push(i.readBytes(r,e+n[l],n[l+1]-n[l]))},t.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],t.CFF.glyphByUnicode=function(r,e){for(var a=0;a<r.charset.length;a++)if(r.charset[a]==e)return a;return-1},t.CFF.glyphBySE=function(r,e){return e<0||e>255?-1:t.CFF.glyphByUnicode(r,t.CFF.tableSE[e])},t.CFF.readEncoding=function(r,e,a){t._bin;var i=[".notdef"],n=r[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var o=r[e];e++;for(var s=0;s<o;s++)i.push(r[e+s]);return i},t.CFF.readCharset=function(r,e,a){var i=t._bin,n=[".notdef"],o=r[e];if(e++,o==0)for(var s=0;s<a;s++){var l=i.readUshort(r,e);e+=2,n.push(l)}else{if(o!=1&&o!=2)throw"error: format: "+o;for(;n.length<a;){l=i.readUshort(r,e),e+=2;var f=0;for(o==1?(f=r[e],e++):(f=i.readUshort(r,e),e+=2),s=0;s<=f;s++)n.push(l),l++}}return n},t.CFF.readIndex=function(r,e,a){var i=t._bin,n=i.readUshort(r,e)+1,o=r[e+=2];if(e++,o==1)for(var s=0;s<n;s++)a.push(r[e+s]);else if(o==2)for(s=0;s<n;s++)a.push(i.readUshort(r,e+2*s));else if(o==3)for(s=0;s<n;s++)a.push(16777215&i.readUint(r,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+o+", count: "+n;return(e+=n*o)-1},t.CFF.getCharString=function(r,e,a){var i=t._bin,n=r[e],o=r[e+1];r[e+2],r[e+3],r[e+4];var s=1,l=null,f=null;n<=20&&(l=n,s=1),n==12&&(l=100*n+o,s=2),21<=n&&n<=27&&(l=n,s=1),n==28&&(f=i.readShort(r,e+1),s=3),29<=n&&n<=31&&(l=n,s=1),32<=n&&n<=246&&(f=n-139,s=1),247<=n&&n<=250&&(f=256*(n-247)+o+108,s=2),251<=n&&n<=254&&(f=256*-(n-251)-o-108,s=2),n==255&&(f=i.readInt(r,e+1)/65535,s=5),a.val=f??"o"+l,a.size=s},t.CFF.readCharString=function(r,e,a){for(var i=e+a,n=t._bin,o=[];e<i;){var s=r[e],l=r[e+1];r[e+2],r[e+3],r[e+4];var f=1,u=null,p=null;s<=20&&(u=s,f=1),s==12&&(u=100*s+l,f=2),s!=19&&s!=20||(u=s,f=2),21<=s&&s<=27&&(u=s,f=1),s==28&&(p=n.readShort(r,e+1),f=3),29<=s&&s<=31&&(u=s,f=1),32<=s&&s<=246&&(p=s-139,f=1),247<=s&&s<=250&&(p=256*(s-247)+l+108,f=2),251<=s&&s<=254&&(p=256*-(s-251)-l-108,f=2),s==255&&(p=n.readInt(r,e+1)/65535,f=5),o.push(p??"o"+u),e+=f}return o},t.CFF.readDict=function(r,e,a){for(var i=t._bin,n={},o=[];e<a;){var s=r[e],l=r[e+1];r[e+2],r[e+3],r[e+4];var f=1,u=null,p=null;if(s==28&&(p=i.readShort(r,e+1),f=3),s==29&&(p=i.readInt(r,e+1),f=5),32<=s&&s<=246&&(p=s-139,f=1),247<=s&&s<=250&&(p=256*(s-247)+l+108,f=2),251<=s&&s<=254&&(p=256*-(s-251)-l-108,f=2),s==255)throw p=i.readInt(r,e+1)/65535,f=5,"unknown number";if(s==30){var g=[];for(f=1;;){var y=r[e+f];f++;var L=y>>4,x=15&y;if(L!=15&&g.push(L),x!=15&&g.push(x),x==15)break}for(var F="",U=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],T=0;T<g.length;T++)F+=U[g[T]];p=parseFloat(F)}s<=21&&(u=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],f=1,s==12&&(u=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][l],f=2)),u!=null?(n[u]=o.length==1?o[0]:o,o=[]):o.push(p),e+=f}return n},t.cmap={},t.cmap.parse=function(r,e,a){r=new Uint8Array(r.buffer,e,a),e=0;var i=t._bin,n={};i.readUshort(r,e),e+=2;var o=i.readUshort(r,e);e+=2;var s=[];n.tables=[];for(var l=0;l<o;l++){var f=i.readUshort(r,e);e+=2;var u=i.readUshort(r,e);e+=2;var p=i.readUint(r,e);e+=4;var g="p"+f+"e"+u,y=s.indexOf(p);if(y==-1){var L;y=n.tables.length,s.push(p);var x=i.readUshort(r,p);x==0?L=t.cmap.parse0(r,p):x==4?L=t.cmap.parse4(r,p):x==6?L=t.cmap.parse6(r,p):x==12?L=t.cmap.parse12(r,p):console.debug("unknown format: "+x,f,u,p),n.tables.push(L)}if(n[g]!=null)throw"multiple tables for one platform+encoding";n[g]=y}return n},t.cmap.parse0=function(r,e){var a=t._bin,i={};i.format=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2,i.map=[];for(var o=0;o<n-6;o++)i.map.push(r[e+o]);return i},t.cmap.parse4=function(r,e){var a=t._bin,i=e,n={};n.format=a.readUshort(r,e),e+=2;var o=a.readUshort(r,e);e+=2,a.readUshort(r,e),e+=2;var s=a.readUshort(r,e);e+=2;var l=s/2;n.searchRange=a.readUshort(r,e),e+=2,n.entrySelector=a.readUshort(r,e),e+=2,n.rangeShift=a.readUshort(r,e),e+=2,n.endCount=a.readUshorts(r,e,l),e+=2*l,e+=2,n.startCount=a.readUshorts(r,e,l),e+=2*l,n.idDelta=[];for(var f=0;f<l;f++)n.idDelta.push(a.readShort(r,e)),e+=2;for(n.idRangeOffset=a.readUshorts(r,e,l),e+=2*l,n.glyphIdArray=[];e<i+o;)n.glyphIdArray.push(a.readUshort(r,e)),e+=2;return n},t.cmap.parse6=function(r,e){var a=t._bin,i={};i.format=a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,a.readUshort(r,e),e+=2,i.firstCode=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2,i.glyphIdArray=[];for(var o=0;o<n;o++)i.glyphIdArray.push(a.readUshort(r,e)),e+=2;return i},t.cmap.parse12=function(r,e){var a=t._bin,i={};i.format=a.readUshort(r,e),e+=2,e+=2,a.readUint(r,e),e+=4,a.readUint(r,e),e+=4;var n=a.readUint(r,e);e+=4,i.groups=[];for(var o=0;o<n;o++){var s=e+12*o,l=a.readUint(r,s+0),f=a.readUint(r,s+4),u=a.readUint(r,s+8);i.groups.push([l,f,u])}return i},t.glyf={},t.glyf.parse=function(r,e,a,i){for(var n=[],o=0;o<i.maxp.numGlyphs;o++)n.push(null);return n},t.glyf._parseGlyf=function(r,e){var a=t._bin,i=r._data,n=t._tabOffset(i,"glyf",r._offset)+r.loca[e];if(r.loca[e]==r.loca[e+1])return null;var o={};if(o.noc=a.readShort(i,n),n+=2,o.xMin=a.readShort(i,n),n+=2,o.yMin=a.readShort(i,n),n+=2,o.xMax=a.readShort(i,n),n+=2,o.yMax=a.readShort(i,n),n+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(a.readUshort(i,n)),n+=2;var l=a.readUshort(i,n);if(n+=2,i.length-n<l)return null;o.instructions=a.readBytes(i,n,l),n+=l;var f=o.endPts[o.noc-1]+1;for(o.flags=[],s=0;s<f;s++){var u=i[n];if(n++,o.flags.push(u),(8&u)!=0){var p=i[n];n++;for(var g=0;g<p;g++)o.flags.push(u),s++}}for(o.xs=[],s=0;s<f;s++){var y=(2&o.flags[s])!=0,L=(16&o.flags[s])!=0;y?(o.xs.push(L?i[n]:-i[n]),n++):L?o.xs.push(0):(o.xs.push(a.readShort(i,n)),n+=2)}for(o.ys=[],s=0;s<f;s++)y=(4&o.flags[s])!=0,L=(32&o.flags[s])!=0,y?(o.ys.push(L?i[n]:-i[n]),n++):L?o.ys.push(0):(o.ys.push(a.readShort(i,n)),n+=2);var x=0,F=0;for(s=0;s<f;s++)x+=o.xs[s],F+=o.ys[s],o.xs[s]=x,o.ys[s]=F}else{var U;o.parts=[];do{U=a.readUshort(i,n),n+=2;var T={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(T),T.glyphIndex=a.readUshort(i,n),n+=2,1&U){var R=a.readShort(i,n);n+=2;var S=a.readShort(i,n);n+=2}else R=a.readInt8(i,n),n++,S=a.readInt8(i,n),n++;2&U?(T.m.tx=R,T.m.ty=S):(T.p1=R,T.p2=S),8&U?(T.m.a=T.m.d=a.readF2dot14(i,n),n+=2):64&U?(T.m.a=a.readF2dot14(i,n),n+=2,T.m.d=a.readF2dot14(i,n),n+=2):128&U&&(T.m.a=a.readF2dot14(i,n),n+=2,T.m.b=a.readF2dot14(i,n),n+=2,T.m.c=a.readF2dot14(i,n),n+=2,T.m.d=a.readF2dot14(i,n),n+=2)}while(32&U);if(256&U){var C=a.readUshort(i,n);for(n+=2,o.instr=[],s=0;s<C;s++)o.instr.push(i[n]),n++}}return o},t.GDEF={},t.GDEF.parse=function(r,e,a,i){var n=e;e+=4;var o=t._bin.readUshort(r,e);return{glyphClassDef:o===0?null:t._lctf.readClassDef(r,n+o)}},t.GPOS={},t.GPOS.parse=function(r,e,a,i){return t._lctf.parse(r,e,a,i,t.GPOS.subt)},t.GPOS.subt=function(r,e,a,i){var n=t._bin,o=a,s={};if(s.fmt=n.readUshort(r,a),a+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var l=n.readUshort(r,a);a+=2,s.coverage=t._lctf.readCoverage(r,l+o)}if(e==1&&s.fmt==1){var f=n.readUshort(r,a);a+=2,f!=0&&(s.pos=t.GPOS.readValueRecord(r,a,f))}else if(e==2&&s.fmt>=1&&s.fmt<=2){f=n.readUshort(r,a),a+=2;var u=n.readUshort(r,a);a+=2;var p=t._lctf.numOfOnes(f),g=t._lctf.numOfOnes(u);if(s.fmt==1){s.pairsets=[];var y=n.readUshort(r,a);a+=2;for(var L=0;L<y;L++){var x=o+n.readUshort(r,a);a+=2;var F=n.readUshort(r,x);x+=2;for(var U=[],T=0;T<F;T++){var R=n.readUshort(r,x);x+=2,f!=0&&(m=t.GPOS.readValueRecord(r,x,f),x+=2*p),u!=0&&(D=t.GPOS.readValueRecord(r,x,u),x+=2*g),U.push({gid2:R,val1:m,val2:D})}s.pairsets.push(U)}}if(s.fmt==2){var S=n.readUshort(r,a);a+=2;var C=n.readUshort(r,a);a+=2;var I=n.readUshort(r,a);a+=2;var M=n.readUshort(r,a);for(a+=2,s.classDef1=t._lctf.readClassDef(r,o+S),s.classDef2=t._lctf.readClassDef(r,o+C),s.matrix=[],L=0;L<I;L++){var J=[];for(T=0;T<M;T++){var m=null,D=null;f!=0&&(m=t.GPOS.readValueRecord(r,a,f),a+=2*p),u!=0&&(D=t.GPOS.readValueRecord(r,a,u),a+=2*g),J.push({val1:m,val2:D})}s.matrix.push(J)}}}else if(e==4&&s.fmt==1)s.markCoverage=t._lctf.readCoverage(r,n.readUshort(r,a)+o),s.baseCoverage=t._lctf.readCoverage(r,n.readUshort(r,a+2)+o),s.markClassCount=n.readUshort(r,a+4),s.markArray=t.GPOS.readMarkArray(r,n.readUshort(r,a+6)+o),s.baseArray=t.GPOS.readBaseArray(r,n.readUshort(r,a+8)+o,s.markClassCount);else if(e==6&&s.fmt==1)s.mark1Coverage=t._lctf.readCoverage(r,n.readUshort(r,a)+o),s.mark2Coverage=t._lctf.readCoverage(r,n.readUshort(r,a+2)+o),s.markClassCount=n.readUshort(r,a+4),s.mark1Array=t.GPOS.readMarkArray(r,n.readUshort(r,a+6)+o),s.mark2Array=t.GPOS.readBaseArray(r,n.readUshort(r,a+8)+o,s.markClassCount);else{if(e==9&&s.fmt==1){var w=n.readUshort(r,a);a+=2;var X=n.readUint(r,a);if(a+=4,i.ltype==9)i.ltype=w;else if(i.ltype!=w)throw"invalid extension substitution";return t.GPOS.subt(r,i.ltype,o+X)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},t.GPOS.readValueRecord=function(r,e,a){var i=t._bin,n=[];return n.push(1&a?i.readShort(r,e):0),e+=1&a?2:0,n.push(2&a?i.readShort(r,e):0),e+=2&a?2:0,n.push(4&a?i.readShort(r,e):0),e+=4&a?2:0,n.push(8&a?i.readShort(r,e):0),e+=8&a?2:0,n},t.GPOS.readBaseArray=function(r,e,a){var i=t._bin,n=[],o=e,s=i.readUshort(r,e);e+=2;for(var l=0;l<s;l++){for(var f=[],u=0;u<a;u++)f.push(t.GPOS.readAnchorRecord(r,o+i.readUshort(r,e))),e+=2;n.push(f)}return n},t.GPOS.readMarkArray=function(r,e){var a=t._bin,i=[],n=e,o=a.readUshort(r,e);e+=2;for(var s=0;s<o;s++){var l=t.GPOS.readAnchorRecord(r,a.readUshort(r,e+2)+n);l.markClass=a.readUshort(r,e),i.push(l),e+=4}return i},t.GPOS.readAnchorRecord=function(r,e){var a=t._bin,i={};return i.fmt=a.readUshort(r,e),i.x=a.readShort(r,e+2),i.y=a.readShort(r,e+4),i},t.GSUB={},t.GSUB.parse=function(r,e,a,i){return t._lctf.parse(r,e,a,i,t.GSUB.subt)},t.GSUB.subt=function(r,e,a,i){var n=t._bin,o=a,s={};if(s.fmt=n.readUshort(r,a),a+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var l=n.readUshort(r,a);a+=2,s.coverage=t._lctf.readCoverage(r,o+l)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(r,a),a+=2;else if(s.fmt==2){var f=n.readUshort(r,a);a+=2,s.newg=n.readUshorts(r,a,f),a+=2*s.newg.length}}else if(e==2&&s.fmt==1){f=n.readUshort(r,a),a+=2,s.seqs=[];for(var u=0;u<f;u++){var p=n.readUshort(r,a)+o;a+=2;var g=n.readUshort(r,p);s.seqs.push(n.readUshorts(r,p+2,g))}}else if(e==4)for(s.vals=[],f=n.readUshort(r,a),a+=2,u=0;u<f;u++){var y=n.readUshort(r,a);a+=2,s.vals.push(t.GSUB.readLigatureSet(r,o+y))}else if(e==5&&s.fmt==2){if(s.fmt==2){var L=n.readUshort(r,a);a+=2,s.cDef=t._lctf.readClassDef(r,o+L),s.scset=[];var x=n.readUshort(r,a);for(a+=2,u=0;u<x;u++){var F=n.readUshort(r,a);a+=2,s.scset.push(F==0?null:t.GSUB.readSubClassSet(r,o+F))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(u=0;u<3;u++){f=n.readUshort(r,a),a+=2;for(var U=[],T=0;T<f;T++)U.push(t._lctf.readCoverage(r,o+n.readUshort(r,a+2*T)));a+=2*f,u==0&&(s.backCvg=U),u==1&&(s.inptCvg=U),u==2&&(s.ahedCvg=U)}f=n.readUshort(r,a),a+=2,s.lookupRec=t.GSUB.readSubstLookupRecords(r,a,f)}}else{if(e==7&&s.fmt==1){var R=n.readUshort(r,a);a+=2;var S=n.readUint(r,a);if(a+=4,i.ltype==9)i.ltype=R;else if(i.ltype!=R)throw"invalid extension substitution";return t.GSUB.subt(r,i.ltype,o+S)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},t.GSUB.readSubClassSet=function(r,e){var a=t._bin.readUshort,i=e,n=[],o=a(r,e);e+=2;for(var s=0;s<o;s++){var l=a(r,e);e+=2,n.push(t.GSUB.readSubClassRule(r,i+l))}return n},t.GSUB.readSubClassRule=function(r,e){var a=t._bin.readUshort,i={},n=a(r,e),o=a(r,e+=2);e+=2,i.input=[];for(var s=0;s<n-1;s++)i.input.push(a(r,e)),e+=2;return i.substLookupRecords=t.GSUB.readSubstLookupRecords(r,e,o),i},t.GSUB.readSubstLookupRecords=function(r,e,a){for(var i=t._bin.readUshort,n=[],o=0;o<a;o++)n.push(i(r,e),i(r,e+2)),e+=4;return n},t.GSUB.readChainSubClassSet=function(r,e){var a=t._bin,i=e,n=[],o=a.readUshort(r,e);e+=2;for(var s=0;s<o;s++){var l=a.readUshort(r,e);e+=2,n.push(t.GSUB.readChainSubClassRule(r,i+l))}return n},t.GSUB.readChainSubClassRule=function(r,e){for(var a=t._bin,i={},n=["backtrack","input","lookahead"],o=0;o<n.length;o++){var s=a.readUshort(r,e);e+=2,o==1&&s--,i[n[o]]=a.readUshorts(r,e,s),e+=2*i[n[o]].length}return s=a.readUshort(r,e),e+=2,i.subst=a.readUshorts(r,e,2*s),e+=2*i.subst.length,i},t.GSUB.readLigatureSet=function(r,e){var a=t._bin,i=e,n=[],o=a.readUshort(r,e);e+=2;for(var s=0;s<o;s++){var l=a.readUshort(r,e);e+=2,n.push(t.GSUB.readLigature(r,i+l))}return n},t.GSUB.readLigature=function(r,e){var a=t._bin,i={chain:[]};i.nglyph=a.readUshort(r,e),e+=2;var n=a.readUshort(r,e);e+=2;for(var o=0;o<n-1;o++)i.chain.push(a.readUshort(r,e)),e+=2;return i},t.head={},t.head.parse=function(r,e,a){var i=t._bin,n={};return i.readFixed(r,e),e+=4,n.fontRevision=i.readFixed(r,e),e+=4,i.readUint(r,e),e+=4,i.readUint(r,e),e+=4,n.flags=i.readUshort(r,e),e+=2,n.unitsPerEm=i.readUshort(r,e),e+=2,n.created=i.readUint64(r,e),e+=8,n.modified=i.readUint64(r,e),e+=8,n.xMin=i.readShort(r,e),e+=2,n.yMin=i.readShort(r,e),e+=2,n.xMax=i.readShort(r,e),e+=2,n.yMax=i.readShort(r,e),e+=2,n.macStyle=i.readUshort(r,e),e+=2,n.lowestRecPPEM=i.readUshort(r,e),e+=2,n.fontDirectionHint=i.readShort(r,e),e+=2,n.indexToLocFormat=i.readShort(r,e),e+=2,n.glyphDataFormat=i.readShort(r,e),e+=2,n},t.hhea={},t.hhea.parse=function(r,e,a){var i=t._bin,n={};return i.readFixed(r,e),e+=4,n.ascender=i.readShort(r,e),e+=2,n.descender=i.readShort(r,e),e+=2,n.lineGap=i.readShort(r,e),e+=2,n.advanceWidthMax=i.readUshort(r,e),e+=2,n.minLeftSideBearing=i.readShort(r,e),e+=2,n.minRightSideBearing=i.readShort(r,e),e+=2,n.xMaxExtent=i.readShort(r,e),e+=2,n.caretSlopeRise=i.readShort(r,e),e+=2,n.caretSlopeRun=i.readShort(r,e),e+=2,n.caretOffset=i.readShort(r,e),e+=2,e+=8,n.metricDataFormat=i.readShort(r,e),e+=2,n.numberOfHMetrics=i.readUshort(r,e),e+=2,n},t.hmtx={},t.hmtx.parse=function(r,e,a,i){for(var n=t._bin,o={aWidth:[],lsBearing:[]},s=0,l=0,f=0;f<i.maxp.numGlyphs;f++)f<i.hhea.numberOfHMetrics&&(s=n.readUshort(r,e),e+=2,l=n.readShort(r,e),e+=2),o.aWidth.push(s),o.lsBearing.push(l);return o},t.kern={},t.kern.parse=function(r,e,a,i){var n=t._bin,o=n.readUshort(r,e);if(e+=2,o==1)return t.kern.parseV1(r,e-2,a,i);var s=n.readUshort(r,e);e+=2;for(var l={glyph1:[],rval:[]},f=0;f<s;f++){e+=2,a=n.readUshort(r,e),e+=2;var u=n.readUshort(r,e);e+=2;var p=u>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;e=t.kern.readFormat0(r,e,l)}return l},t.kern.parseV1=function(r,e,a,i){var n=t._bin;n.readFixed(r,e),e+=4;var o=n.readUint(r,e);e+=4;for(var s={glyph1:[],rval:[]},l=0;l<o;l++){n.readUint(r,e),e+=4;var f=n.readUshort(r,e);e+=2,n.readUshort(r,e),e+=2;var u=f>>>8;if((u&=15)!=0)throw"unknown kern table format: "+u;e=t.kern.readFormat0(r,e,s)}return s},t.kern.readFormat0=function(r,e,a){var i=t._bin,n=-1,o=i.readUshort(r,e);e+=2,i.readUshort(r,e),e+=2,i.readUshort(r,e),e+=2,i.readUshort(r,e),e+=2;for(var s=0;s<o;s++){var l=i.readUshort(r,e);e+=2;var f=i.readUshort(r,e);e+=2;var u=i.readShort(r,e);e+=2,l!=n&&(a.glyph1.push(l),a.rval.push({glyph2:[],vals:[]}));var p=a.rval[a.rval.length-1];p.glyph2.push(f),p.vals.push(u),n=l}return e},t.loca={},t.loca.parse=function(r,e,a,i){var n=t._bin,o=[],s=i.head.indexToLocFormat,l=i.maxp.numGlyphs+1;if(s==0)for(var f=0;f<l;f++)o.push(n.readUshort(r,e+(f<<1))<<1);if(s==1)for(f=0;f<l;f++)o.push(n.readUint(r,e+(f<<2)));return o},t.maxp={},t.maxp.parse=function(r,e,a){var i=t._bin,n={},o=i.readUint(r,e);return e+=4,n.numGlyphs=i.readUshort(r,e),e+=2,o==65536&&(n.maxPoints=i.readUshort(r,e),e+=2,n.maxContours=i.readUshort(r,e),e+=2,n.maxCompositePoints=i.readUshort(r,e),e+=2,n.maxCompositeContours=i.readUshort(r,e),e+=2,n.maxZones=i.readUshort(r,e),e+=2,n.maxTwilightPoints=i.readUshort(r,e),e+=2,n.maxStorage=i.readUshort(r,e),e+=2,n.maxFunctionDefs=i.readUshort(r,e),e+=2,n.maxInstructionDefs=i.readUshort(r,e),e+=2,n.maxStackElements=i.readUshort(r,e),e+=2,n.maxSizeOfInstructions=i.readUshort(r,e),e+=2,n.maxComponentElements=i.readUshort(r,e),e+=2,n.maxComponentDepth=i.readUshort(r,e),e+=2),n},t.name={},t.name.parse=function(r,e,a){var i=t._bin,n={};i.readUshort(r,e),e+=2;var o=i.readUshort(r,e);e+=2,i.readUshort(r,e);for(var s,l=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=e+=2,u=0;u<o;u++){var p=i.readUshort(r,e);e+=2;var g=i.readUshort(r,e);e+=2;var y=i.readUshort(r,e);e+=2;var L=i.readUshort(r,e);e+=2;var x=i.readUshort(r,e);e+=2;var F=i.readUshort(r,e);e+=2;var U,T=l[L],R=f+12*o+F;if(p==0)U=i.readUnicode(r,R,x/2);else if(p==3&&g==0)U=i.readUnicode(r,R,x/2);else if(g==0)U=i.readASCII(r,R,x);else if(g==1)U=i.readUnicode(r,R,x/2);else if(g==3)U=i.readUnicode(r,R,x/2);else{if(p!=1)throw"unknown encoding "+g+", platformID: "+p;U=i.readASCII(r,R,x),console.debug("reading unknown MAC encoding "+g+" as ASCII")}var S="p"+p+","+y.toString(16);n[S]==null&&(n[S]={}),n[S][T!==void 0?T:L]=U,n[S]._lang=y}for(var C in n)if(n[C].postScriptName!=null&&n[C]._lang==1033)return n[C];for(var C in n)if(n[C].postScriptName!=null&&n[C]._lang==0)return n[C];for(var C in n)if(n[C].postScriptName!=null&&n[C]._lang==3084)return n[C];for(var C in n)if(n[C].postScriptName!=null)return n[C];for(var C in n){s=C;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},t["OS/2"]={},t["OS/2"].parse=function(r,e,a){var i=t._bin.readUshort(r,e);e+=2;var n={};if(i==0)t["OS/2"].version0(r,e,n);else if(i==1)t["OS/2"].version1(r,e,n);else if(i==2||i==3||i==4)t["OS/2"].version2(r,e,n);else{if(i!=5)throw"unknown OS/2 table version: "+i;t["OS/2"].version5(r,e,n)}return n},t["OS/2"].version0=function(r,e,a){var i=t._bin;return a.xAvgCharWidth=i.readShort(r,e),e+=2,a.usWeightClass=i.readUshort(r,e),e+=2,a.usWidthClass=i.readUshort(r,e),e+=2,a.fsType=i.readUshort(r,e),e+=2,a.ySubscriptXSize=i.readShort(r,e),e+=2,a.ySubscriptYSize=i.readShort(r,e),e+=2,a.ySubscriptXOffset=i.readShort(r,e),e+=2,a.ySubscriptYOffset=i.readShort(r,e),e+=2,a.ySuperscriptXSize=i.readShort(r,e),e+=2,a.ySuperscriptYSize=i.readShort(r,e),e+=2,a.ySuperscriptXOffset=i.readShort(r,e),e+=2,a.ySuperscriptYOffset=i.readShort(r,e),e+=2,a.yStrikeoutSize=i.readShort(r,e),e+=2,a.yStrikeoutPosition=i.readShort(r,e),e+=2,a.sFamilyClass=i.readShort(r,e),e+=2,a.panose=i.readBytes(r,e,10),e+=10,a.ulUnicodeRange1=i.readUint(r,e),e+=4,a.ulUnicodeRange2=i.readUint(r,e),e+=4,a.ulUnicodeRange3=i.readUint(r,e),e+=4,a.ulUnicodeRange4=i.readUint(r,e),e+=4,a.achVendID=[i.readInt8(r,e),i.readInt8(r,e+1),i.readInt8(r,e+2),i.readInt8(r,e+3)],e+=4,a.fsSelection=i.readUshort(r,e),e+=2,a.usFirstCharIndex=i.readUshort(r,e),e+=2,a.usLastCharIndex=i.readUshort(r,e),e+=2,a.sTypoAscender=i.readShort(r,e),e+=2,a.sTypoDescender=i.readShort(r,e),e+=2,a.sTypoLineGap=i.readShort(r,e),e+=2,a.usWinAscent=i.readUshort(r,e),e+=2,a.usWinDescent=i.readUshort(r,e),e+=2},t["OS/2"].version1=function(r,e,a){var i=t._bin;return e=t["OS/2"].version0(r,e,a),a.ulCodePageRange1=i.readUint(r,e),e+=4,a.ulCodePageRange2=i.readUint(r,e),e+=4},t["OS/2"].version2=function(r,e,a){var i=t._bin;return e=t["OS/2"].version1(r,e,a),a.sxHeight=i.readShort(r,e),e+=2,a.sCapHeight=i.readShort(r,e),e+=2,a.usDefault=i.readUshort(r,e),e+=2,a.usBreak=i.readUshort(r,e),e+=2,a.usMaxContext=i.readUshort(r,e),e+=2},t["OS/2"].version5=function(r,e,a){var i=t._bin;return e=t["OS/2"].version2(r,e,a),a.usLowerOpticalPointSize=i.readUshort(r,e),e+=2,a.usUpperOpticalPointSize=i.readUshort(r,e),e+=2},t.post={},t.post.parse=function(r,e,a){var i=t._bin,n={};return n.version=i.readFixed(r,e),e+=4,n.italicAngle=i.readFixed(r,e),e+=4,n.underlinePosition=i.readShort(r,e),e+=2,n.underlineThickness=i.readShort(r,e),e+=2,n},t==null&&(t={}),t.U==null&&(t.U={}),t.U.codeToGlyph=function(r,e){var a=r.cmap,i=-1;if(a.p0e4!=null?i=a.p0e4:a.p3e1!=null?i=a.p3e1:a.p1e0!=null?i=a.p1e0:a.p0e3!=null&&(i=a.p0e3),i==-1)throw"no familiar platform and encoding!";var n=a.tables[i];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var o=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){o=s;break}return o==-1||n.startCount[o]>e?0:65535&(n.idRangeOffset[o]!=0?n.glyphIdArray[e-n.startCount[o]+(n.idRangeOffset[o]>>1)-(n.idRangeOffset.length-o)]:e+n.idDelta[o])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var l=n.groups[s];if(l[0]<=e&&e<=l[1])return l[2]+(e-l[0])}return 0}throw"unknown cmap table format "+n.format},t.U.glyphToPath=function(r,e){var a={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[e]){var i=r.SVG.entries[e];return i==null?a:(typeof i=="string"&&(i=t.SVG.toPath(i),r.SVG.entries[e]=i),i)}if(r.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},o=r.CFF,s=r.CFF.Private;if(o.ROS){for(var l=0;o.FDSelect[l+2]<=e;)l+=2;s=o.FDArray[o.FDSelect[l+1]].Private}t.U._drawCFF(r.CFF.CharStrings[e],n,o,s,a)}else r.glyf&&t.U._drawGlyf(e,r,a);return a},t.U._drawGlyf=function(r,e,a){var i=e.glyf[r];i==null&&(i=e.glyf[r]=t.glyf._parseGlyf(e,r)),i!=null&&(i.noc>-1?t.U._simpleGlyph(i,a):t.U._compoGlyph(i,e,a))},t.U._simpleGlyph=function(r,e){for(var a=0;a<r.noc;a++){for(var i=a==0?0:r.endPts[a-1]+1,n=r.endPts[a],o=i;o<=n;o++){var s=o==i?n:o-1,l=o==n?i:o+1,f=1&r.flags[o],u=1&r.flags[s],p=1&r.flags[l],g=r.xs[o],y=r.ys[o];if(o==i)if(f){if(!u){t.U.P.moveTo(e,g,y);continue}t.U.P.moveTo(e,r.xs[s],r.ys[s])}else u?t.U.P.moveTo(e,r.xs[s],r.ys[s]):t.U.P.moveTo(e,(r.xs[s]+g)/2,(r.ys[s]+y)/2);f?u&&t.U.P.lineTo(e,g,y):p?t.U.P.qcurveTo(e,g,y,r.xs[l],r.ys[l]):t.U.P.qcurveTo(e,g,y,(g+r.xs[l])/2,(y+r.ys[l])/2)}t.U.P.closePath(e)}},t.U._compoGlyph=function(r,e,a){for(var i=0;i<r.parts.length;i++){var n={cmds:[],crds:[]},o=r.parts[i];t.U._drawGlyf(o.glyphIndex,e,n);for(var s=o.m,l=0;l<n.crds.length;l+=2){var f=n.crds[l],u=n.crds[l+1];a.crds.push(f*s.a+u*s.b+s.tx),a.crds.push(f*s.c+u*s.d+s.ty)}for(l=0;l<n.cmds.length;l++)a.cmds.push(n.cmds[l])}},t.U._getGlyphClass=function(r,e){var a=t._lctf.getInterval(e,r);return a==-1?0:e[a+2]},t.U._applySubs=function(r,e,a,i){for(var n=r.length-e-1,o=0;o<a.tabs.length;o++)if(a.tabs[o]!=null){var s,l=a.tabs[o];if(!l.coverage||(s=t._lctf.coverageIndex(l.coverage,r[e]))!=-1){if(a.ltype==1)r[e],l.fmt==1?r[e]=r[e]+l.delta:r[e]=l.newg[s];else if(a.ltype==4)for(var f=l.vals[s],u=0;u<f.length;u++){var p=f[u],g=p.chain.length;if(!(g>n)){for(var y=!0,L=0,x=0;x<g;x++){for(;r[e+L+(1+x)]==-1;)L++;p.chain[x]!=r[e+L+(1+x)]&&(y=!1)}if(y){for(r[e]=p.nglyph,x=0;x<g+L;x++)r[e+x+1]=-1;break}}}else if(a.ltype==5&&l.fmt==2)for(var F=t._lctf.getInterval(l.cDef,r[e]),U=l.cDef[F+2],T=l.scset[U],R=0;R<T.length;R++){var S=T[R],C=S.input;if(!(C.length>n)){for(y=!0,x=0;x<C.length;x++){var I=t._lctf.getInterval(l.cDef,r[e+1+x]);if(F==-1&&l.cDef[I+2]!=C[x]){y=!1;break}}if(y){var M=S.substLookupRecords;for(u=0;u<M.length;u+=2)M[u],M[u+1]}}}else if(a.ltype==6&&l.fmt==3){if(!t.U._glsCovered(r,l.backCvg,e-l.backCvg.length)||!t.U._glsCovered(r,l.inptCvg,e)||!t.U._glsCovered(r,l.ahedCvg,e+l.inptCvg.length))continue;var J=l.lookupRec;for(R=0;R<J.length;R+=2){F=J[R];var m=i[J[R+1]];t.U._applySubs(r,e+F,m,i)}}}}},t.U._glsCovered=function(r,e,a){for(var i=0;i<e.length;i++)if(t._lctf.coverageIndex(e[i],r[a+i])==-1)return!1;return!0},t.U.glyphsToPath=function(r,e,a){for(var i={cmds:[],crds:[]},n=0,o=0;o<e.length;o++){var s=e[o];if(s!=-1){for(var l=o<e.length-1&&e[o+1]!=-1?e[o+1]:0,f=t.U.glyphToPath(r,s),u=0;u<f.crds.length;u+=2)i.crds.push(f.crds[u]+n),i.crds.push(f.crds[u+1]);for(a&&i.cmds.push(a),u=0;u<f.cmds.length;u++)i.cmds.push(f.cmds[u]);a&&i.cmds.push("X"),n+=r.hmtx.aWidth[s],o<e.length-1&&(n+=t.U.getPairAdjustment(r,s,l))}}return i},t.U.P={},t.U.P.moveTo=function(r,e,a){r.cmds.push("M"),r.crds.push(e,a)},t.U.P.lineTo=function(r,e,a){r.cmds.push("L"),r.crds.push(e,a)},t.U.P.curveTo=function(r,e,a,i,n,o,s){r.cmds.push("C"),r.crds.push(e,a,i,n,o,s)},t.U.P.qcurveTo=function(r,e,a,i,n){r.cmds.push("Q"),r.crds.push(e,a,i,n)},t.U.P.closePath=function(r){r.cmds.push("Z")},t.U._drawCFF=function(r,e,a,i,n){for(var o=e.stack,s=e.nStems,l=e.haveWidth,f=e.width,u=e.open,p=0,g=e.x,y=e.y,L=0,x=0,F=0,U=0,T=0,R=0,S=0,C=0,I=0,M=0,J={val:0,size:0};p<r.length;){t.CFF.getCharString(r,p,J);var m=J.val;if(p+=J.size,m=="o1"||m=="o18")o.length%2!=0&&!l&&(f=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,l=!0;else if(m=="o3"||m=="o23")o.length%2!=0&&!l&&(f=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,l=!0;else if(m=="o4")o.length>1&&!l&&(f=o.shift()+i.nominalWidthX,l=!0),u&&t.U.P.closePath(n),y+=o.pop(),t.U.P.moveTo(n,g,y),u=!0;else if(m=="o5")for(;o.length>0;)g+=o.shift(),y+=o.shift(),t.U.P.lineTo(n,g,y);else if(m=="o6"||m=="o7")for(var D=o.length,w=m=="o6",X=0;X<D;X++){var z=o.shift();w?g+=z:y+=z,w=!w,t.U.P.lineTo(n,g,y)}else if(m=="o8"||m=="o24"){D=o.length;for(var Z=0;Z+6<=D;)L=g+o.shift(),x=y+o.shift(),F=L+o.shift(),U=x+o.shift(),g=F+o.shift(),y=U+o.shift(),t.U.P.curveTo(n,L,x,F,U,g,y),Z+=6;m=="o24"&&(g+=o.shift(),y+=o.shift(),t.U.P.lineTo(n,g,y))}else{if(m=="o11")break;if(m=="o1234"||m=="o1235"||m=="o1236"||m=="o1237")m=="o1234"&&(x=y,F=(L=g+o.shift())+o.shift(),M=U=x+o.shift(),R=U,C=y,g=(S=(T=(I=F+o.shift())+o.shift())+o.shift())+o.shift(),t.U.P.curveTo(n,L,x,F,U,I,M),t.U.P.curveTo(n,T,R,S,C,g,y)),m=="o1235"&&(L=g+o.shift(),x=y+o.shift(),F=L+o.shift(),U=x+o.shift(),I=F+o.shift(),M=U+o.shift(),T=I+o.shift(),R=M+o.shift(),S=T+o.shift(),C=R+o.shift(),g=S+o.shift(),y=C+o.shift(),o.shift(),t.U.P.curveTo(n,L,x,F,U,I,M),t.U.P.curveTo(n,T,R,S,C,g,y)),m=="o1236"&&(L=g+o.shift(),x=y+o.shift(),F=L+o.shift(),M=U=x+o.shift(),R=U,S=(T=(I=F+o.shift())+o.shift())+o.shift(),C=R+o.shift(),g=S+o.shift(),t.U.P.curveTo(n,L,x,F,U,I,M),t.U.P.curveTo(n,T,R,S,C,g,y)),m=="o1237"&&(L=g+o.shift(),x=y+o.shift(),F=L+o.shift(),U=x+o.shift(),I=F+o.shift(),M=U+o.shift(),T=I+o.shift(),R=M+o.shift(),S=T+o.shift(),C=R+o.shift(),Math.abs(S-g)>Math.abs(C-y)?g=S+o.shift():y=C+o.shift(),t.U.P.curveTo(n,L,x,F,U,I,M),t.U.P.curveTo(n,T,R,S,C,g,y));else if(m=="o14"){if(o.length>0&&!l&&(f=o.shift()+a.nominalWidthX,l=!0),o.length==4){var te=o.shift(),B=o.shift(),G=o.shift(),d=o.shift(),b=t.CFF.glyphBySE(a,G),k=t.CFF.glyphBySE(a,d);t.U._drawCFF(a.CharStrings[b],e,a,i,n),e.x=te,e.y=B,t.U._drawCFF(a.CharStrings[k],e,a,i,n)}u&&(t.U.P.closePath(n),u=!1)}else if(m=="o19"||m=="o20")o.length%2!=0&&!l&&(f=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,l=!0,p+=s+7>>3;else if(m=="o21")o.length>2&&!l&&(f=o.shift()+i.nominalWidthX,l=!0),y+=o.pop(),g+=o.pop(),u&&t.U.P.closePath(n),t.U.P.moveTo(n,g,y),u=!0;else if(m=="o22")o.length>1&&!l&&(f=o.shift()+i.nominalWidthX,l=!0),g+=o.pop(),u&&t.U.P.closePath(n),t.U.P.moveTo(n,g,y),u=!0;else if(m=="o25"){for(;o.length>6;)g+=o.shift(),y+=o.shift(),t.U.P.lineTo(n,g,y);L=g+o.shift(),x=y+o.shift(),F=L+o.shift(),U=x+o.shift(),g=F+o.shift(),y=U+o.shift(),t.U.P.curveTo(n,L,x,F,U,g,y)}else if(m=="o26")for(o.length%2&&(g+=o.shift());o.length>0;)L=g,x=y+o.shift(),g=F=L+o.shift(),y=(U=x+o.shift())+o.shift(),t.U.P.curveTo(n,L,x,F,U,g,y);else if(m=="o27")for(o.length%2&&(y+=o.shift());o.length>0;)x=y,F=(L=g+o.shift())+o.shift(),U=x+o.shift(),g=F+o.shift(),y=U,t.U.P.curveTo(n,L,x,F,U,g,y);else if(m=="o10"||m=="o29"){var A=m=="o10"?i:a;if(o.length==0)console.debug("error: empty stack");else{var _=o.pop(),N=A.Subrs[_+A.Bias];e.x=g,e.y=y,e.nStems=s,e.haveWidth=l,e.width=f,e.open=u,t.U._drawCFF(N,e,a,i,n),g=e.x,y=e.y,s=e.nStems,l=e.haveWidth,f=e.width,u=e.open}}else if(m=="o30"||m=="o31"){var E=o.length,P=(Z=0,m=="o31");for(Z+=E-(D=-3&E);Z<D;)P?(x=y,F=(L=g+o.shift())+o.shift(),y=(U=x+o.shift())+o.shift(),D-Z==5?(g=F+o.shift(),Z++):g=F,P=!1):(L=g,x=y+o.shift(),F=L+o.shift(),U=x+o.shift(),g=F+o.shift(),D-Z==5?(y=U+o.shift(),Z++):y=U,P=!0),t.U.P.curveTo(n,L,x,F,U,g,y),Z+=4}else{if((m+"").charAt(0)=="o")throw console.debug("Unknown operation: "+m,r),m;o.push(m)}}}e.x=g,e.y=y,e.nStems=s,e.haveWidth=l,e.width=f,e.open=u};var v=t,h={Typr:v};return c.Typr=v,c.default=h,Object.defineProperty(c,"__esModule",{value:!0}),c}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Jn(){return function(c){var t=Uint8Array,v=Uint16Array,h=Uint32Array,r=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i=function(m,D){for(var w=new v(31),X=0;X<31;++X)w[X]=D+=1<<m[X-1];var z=new h(w[30]);for(X=1;X<30;++X)for(var Z=w[X];Z<w[X+1];++Z)z[Z]=Z-w[X]<<5|X;return[w,z]},n=i(r,2),o=n[0],s=n[1];o[28]=258,s[258]=28;for(var l=i(e,0)[0],f=new v(32768),u=0;u<32768;++u){var p=(43690&u)>>>1|(21845&u)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,f[u]=((65280&p)>>>8|(255&p)<<8)>>>1}var g=function(m,D,w){for(var X=m.length,z=0,Z=new v(D);z<X;++z)++Z[m[z]-1];var te,B=new v(D);for(z=0;z<D;++z)B[z]=B[z-1]+Z[z-1]<<1;{te=new v(1<<D);var G=15-D;for(z=0;z<X;++z)if(m[z])for(var d=z<<4|m[z],b=D-m[z],k=B[m[z]-1]++<<b,A=k|(1<<b)-1;k<=A;++k)te[f[k]>>>G]=d}return te},y=new t(288);for(u=0;u<144;++u)y[u]=8;for(u=144;u<256;++u)y[u]=9;for(u=256;u<280;++u)y[u]=7;for(u=280;u<288;++u)y[u]=8;var L=new t(32);for(u=0;u<32;++u)L[u]=5;var x=g(y,9),F=g(L,5),U=function(m){for(var D=m[0],w=1;w<m.length;++w)m[w]>D&&(D=m[w]);return D},T=function(m,D,w){var X=D/8|0;return(m[X]|m[X+1]<<8)>>(7&D)&w},R=function(m,D){var w=D/8|0;return(m[w]|m[w+1]<<8|m[w+2]<<16)>>(7&D)},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],C=function(m,D,w){var X=new Error(D||S[m]);if(X.code=m,Error.captureStackTrace&&Error.captureStackTrace(X,C),!w)throw X;return X},I=function(m,D,w){var X=m.length;if(!X||w&&!w.l&&X<5)return D||new t(0);var z=!D||w,Z=!w||w.i;w||(w={}),D||(D=new t(3*X));var te,B=function(fe){var Ce=D.length;if(fe>Ce){var ke=new t(Math.max(2*Ce,fe));ke.set(D),D=ke}},G=w.f||0,d=w.p||0,b=w.b||0,k=w.l,A=w.d,_=w.m,N=w.n,E=8*X;do{if(!k){w.f=G=T(m,d,1);var P=T(m,d+1,3);if(d+=3,!P){var H=m[(q=((te=d)/8|0)+(7&te&&1)+4)-4]|m[q-3]<<8,$=q+H;if($>X){Z&&C(0);break}z&&B(b+H),D.set(m.subarray(q,$),b),w.b=b+=H,w.p=d=8*$;continue}if(P==1)k=x,A=F,_=9,N=5;else if(P==2){var V=T(m,d,31)+257,W=T(m,d+10,15)+4,pe=V+T(m,d+5,31)+1;d+=14;for(var ue=new t(pe),Q=new t(19),ee=0;ee<W;++ee)Q[a[ee]]=T(m,d+3*ee,7);d+=3*W;var se=U(Q),j=(1<<se)-1,re=g(Q,se);for(ee=0;ee<pe;){var q,O=re[T(m,d,j)];if(d+=15&O,(q=O>>>4)<16)ue[ee++]=q;else{var he=0,K=0;for(q==16?(K=3+T(m,d,3),d+=2,he=ue[ee-1]):q==17?(K=3+T(m,d,7),d+=3):q==18&&(K=11+T(m,d,127),d+=7);K--;)ue[ee++]=he}}var ae=ue.subarray(0,V),Y=ue.subarray(V);_=U(ae),N=U(Y),k=g(ae,_),A=g(Y,N)}else C(1);if(d>E){Z&&C(0);break}}z&&B(b+131072);for(var be=(1<<_)-1,ne=(1<<N)-1,oe=d;;oe=d){var le=(he=k[R(m,d)&be])>>>4;if((d+=15&he)>E){Z&&C(0);break}if(he||C(2),le<256)D[b++]=le;else{if(le==256){oe=d,k=null;break}var de=le-254;if(le>264){var Se=r[ee=le-257];de=T(m,d,(1<<Se)-1)+o[ee],d+=Se}var Fe=A[R(m,d)&ne],ge=Fe>>>4;if(Fe||C(3),d+=15&Fe,Y=l[ge],ge>3&&(Se=e[ge],Y+=R(m,d)&(1<<Se)-1,d+=Se),d>E){Z&&C(0);break}z&&B(b+131072);for(var me=b+de;b<me;b+=4)D[b]=D[b-Y],D[b+1]=D[b+1-Y],D[b+2]=D[b+2-Y],D[b+3]=D[b+3-Y];b=me}}w.l=k,w.p=oe,w.b=b,k&&(G=1,w.m=_,w.d=A,w.n=N)}while(!G);return b==D.length?D:function(fe,Ce,ke){(ke==null||ke>fe.length)&&(ke=fe.length);var Le=new(fe instanceof v?v:fe instanceof h?h:t)(ke-Ce);return Le.set(fe.subarray(Ce,ke)),Le}(D,0,b)},M=new t(0),J=typeof TextDecoder<"u"&&new TextDecoder;try{J.decode(M,{stream:!0})}catch{}return c.convert_streams=function(m){var D=new DataView(m),w=0;function X(){var V=D.getUint16(w);return w+=2,V}function z(){var V=D.getUint32(w);return w+=4,V}function Z(V){H.setUint16($,V),$+=2}function te(V){H.setUint32($,V),$+=4}for(var B={signature:z(),flavor:z(),length:z(),numTables:X(),reserved:X(),totalSfntSize:z(),majorVersion:X(),minorVersion:X(),metaOffset:z(),metaLength:z(),metaOrigLength:z(),privOffset:z(),privLength:z()},G=0;Math.pow(2,G)<=B.numTables;)G++;G--;for(var d=16*Math.pow(2,G),b=16*B.numTables-d,k=12,A=[],_=0;_<B.numTables;_++)A.push({tag:z(),offset:z(),compLength:z(),origLength:z(),origChecksum:z()}),k+=16;var N,E=new Uint8Array(12+16*A.length+A.reduce(function(V,W){return V+W.origLength+4},0)),P=E.buffer,H=new DataView(P),$=0;return te(B.flavor),Z(B.numTables),Z(d),Z(G),Z(b),A.forEach(function(V){te(V.tag),te(V.origChecksum),te(k),te(V.origLength),V.outOffset=k,(k+=V.origLength)%4!=0&&(k+=4-k%4)}),A.forEach(function(V){var W,pe=m.slice(V.offset,V.offset+V.compLength);if(V.compLength!=V.origLength){var ue=new Uint8Array(V.origLength);W=new Uint8Array(pe,2),I(W,ue)}else ue=new Uint8Array(pe);E.set(ue,V.outOffset);var Q=0;(k=V.outOffset+V.origLength)%4!=0&&(Q=4-k%4),E.set(new Uint8Array(Q).buffer,V.outOffset+V.origLength),N=k+Q}),P.slice(0,N)},Object.defineProperty(c,"__esModule",{value:!0}),c}({}).convert_streams}function Kn(c,t){const v={M:2,L:2,Q:4,C:6,Z:0},h={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,e=2,a=4,i=8,n=16,o=32;let s;function l(S){if(!s){const C={R:e,L:r,D:a,C:n,U:o,T:i};s=new Map;for(let I in h){let M=0;h[I].split(",").forEach(J=>{let[m,D]=J.split("+");m=parseInt(m,36),D=D?parseInt(D,36):0,s.set(M+=m,C[I]);for(let w=D;w--;)s.set(++M,C[I])})}}return s.get(S)||o}const f=1,u=2,p=3,g=4,y=[null,"isol","init","fina","medi"];function L(S){const C=new Uint8Array(S.length);let I=o,M=f,J=-1;for(let m=0;m<S.length;m++){const D=S.codePointAt(m);let w=l(D)|0,X=f;w&i||(I&(r|a|n)?w&(e|a|n)?(X=p,(M===f||M===p)&&C[J]++):w&(r|o)&&(M===u||M===g)&&C[J]--:I&(e|o)&&(M===u||M===g)&&C[J]--,M=C[m]=X,I=w,J=m,D>65535&&m++)}return C}function x(S,C){const I=[];for(let J=0;J<C.length;J++){const m=C.codePointAt(J);m>65535&&J++,I.push(c.U.codeToGlyph(S,m))}const M=S.GSUB;if(M){const{lookupList:J,featureList:m}=M;let D;const w=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,X=[];m.forEach(z=>{if(w.test(z.tag))for(let Z=0;Z<z.tab.length;Z++){if(X[z.tab[Z]])continue;X[z.tab[Z]]=!0;const te=J[z.tab[Z]],B=/^(isol|init|fina|medi)$/.test(z.tag);B&&!D&&(D=L(C));for(let G=0;G<I.length;G++)(!D||!B||y[D[G]]===z.tag)&&c.U._applySubs(I,G,te,J)}})}return I}function F(S,C){const I=new Int16Array(C.length*3);let M=0;for(;M<C.length;M++){const w=C[M];if(w===-1)continue;I[M*3+2]=S.hmtx.aWidth[w];const X=S.GPOS;if(X){const z=X.lookupList;for(let Z=0;Z<z.length;Z++){const te=z[Z];for(let B=0;B<te.tabs.length;B++){const G=te.tabs[B];if(te.ltype===1){if(c._lctf.coverageIndex(G.coverage,w)!==-1&&G.pos){D(G.pos,M);break}}else if(te.ltype===2){let d=null,b=J();if(b!==-1){const k=c._lctf.coverageIndex(G.coverage,C[b]);if(k!==-1){if(G.fmt===1){const A=G.pairsets[k];for(let _=0;_<A.length;_++)A[_].gid2===w&&(d=A[_])}else if(G.fmt===2){const A=c.U._getGlyphClass(C[b],G.classDef1),_=c.U._getGlyphClass(w,G.classDef2);d=G.matrix[A][_]}if(d){d.val1&&D(d.val1,b),d.val2&&D(d.val2,M);break}}}}else if(te.ltype===4){const d=c._lctf.coverageIndex(G.markCoverage,w);if(d!==-1){const b=J(m),k=b===-1?-1:c._lctf.coverageIndex(G.baseCoverage,C[b]);if(k!==-1){const A=G.markArray[d],_=G.baseArray[k][A.markClass];I[M*3]=_.x-A.x+I[b*3]-I[b*3+2],I[M*3+1]=_.y-A.y+I[b*3+1];break}}}else if(te.ltype===6){const d=c._lctf.coverageIndex(G.mark1Coverage,w);if(d!==-1){const b=J();if(b!==-1){const k=C[b];if(U(S,k)===3){const A=c._lctf.coverageIndex(G.mark2Coverage,k);if(A!==-1){const _=G.mark1Array[d],N=G.mark2Array[A][_.markClass];I[M*3]=N.x-_.x+I[b*3]-I[b*3+2],I[M*3+1]=N.y-_.y+I[b*3+1];break}}}}}}}}else if(S.kern&&!S.cff){const z=J();if(z!==-1){const Z=S.kern.glyph1.indexOf(C[z]);if(Z!==-1){const te=S.kern.rval[Z].glyph2.indexOf(w);te!==-1&&(I[z*3+2]+=S.kern.rval[Z].vals[te])}}}}return I;function J(w){for(let X=M-1;X>=0;X--)if(C[X]!==-1&&(!w||w(C[X])))return X;return-1}function m(w){return U(S,w)===1}function D(w,X){for(let z=0;z<3;z++)I[X*3+z]+=w[z]||0}}function U(S,C){const I=S.GDEF&&S.GDEF.glyphClassDef;return I?c.U._getGlyphClass(C,I):0}function T(...S){for(let C=0;C<S.length;C++)if(typeof S[C]=="number")return S[C]}function R(S){const C=Object.create(null),I=S["OS/2"],M=S.hhea,J=S.head.unitsPerEm,m=T(I&&I.sTypoAscender,M&&M.ascender,J),D={unitsPerEm:J,ascender:m,descender:T(I&&I.sTypoDescender,M&&M.descender,0),capHeight:T(I&&I.sCapHeight,m),xHeight:T(I&&I.sxHeight,m),lineGap:T(I&&I.sTypoLineGap,M&&M.lineGap),supportsCodePoint(w){return c.U.codeToGlyph(S,w)>0},forEachGlyph(w,X,z,Z){let te=0;const B=1/D.unitsPerEm*X,G=x(S,w);let d=0;const b=F(S,G);return G.forEach((k,A)=>{if(k!==-1){let _=C[k];if(!_){const{cmds:N,crds:E}=c.U.glyphToPath(S,k);let P="",H=0;for(let ue=0,Q=N.length;ue<Q;ue++){const ee=v[N[ue]];P+=N[ue];for(let se=1;se<=ee;se++)P+=(se>1?",":"")+E[H++]}let $,V,W,pe;if(E.length){$=V=1/0,W=pe=-1/0;for(let ue=0,Q=E.length;ue<Q;ue+=2){let ee=E[ue],se=E[ue+1];ee<$&&($=ee),se<V&&(V=se),ee>W&&(W=ee),se>pe&&(pe=se)}}else $=W=V=pe=0;_=C[k]={index:k,advanceWidth:S.hmtx.aWidth[k],xMin:$,yMin:V,xMax:W,yMax:pe,path:P}}Z.call(null,_,te+b[A*3]*B,b[A*3+1]*B,d),te+=b[A*3+2]*B,z&&(te+=z*X)}d+=w.codePointAt(d)>65535?2:1}),te}};return D}return function(C){const I=new Uint8Array(C,0,4),M=c._bin.readASCII(I,0,4);if(M==="wOFF")C=t(C);else if(M==="wOF2")throw new Error("woff2 fonts not supported");return R(c.parse(C)[0])}}const Qn=or({name:"Typr Font Parser",dependencies:[Yn,Jn,Kn],init(c,t,v){const h=c(),r=t();return v(h,r)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Zn(){return function(c){var t=function(){this.buckets=new Map};t.prototype.add=function(F){var U=F>>5;this.buckets.set(U,(this.buckets.get(U)||0)|1<<(31&F))},t.prototype.has=function(F){var U=this.buckets.get(F>>5);return U!==void 0&&(U&1<<(31&F))!=0},t.prototype.serialize=function(){var F=[];return this.buckets.forEach(function(U,T){F.push((+T).toString(36)+":"+U.toString(36))}),F.join(",")},t.prototype.deserialize=function(F){var U=this;this.buckets.clear(),F.split(",").forEach(function(T){var R=T.split(":");U.buckets.set(parseInt(R[0],36),parseInt(R[1],36))})};var v=Math.pow(2,8),h=v-1,r=~h;function e(F){var U=function(R){return R&r}(F).toString(16),T=function(R){return(R&r)+v-1}(F).toString(16);return"codepoint-index/plane"+(F>>16)+"/"+U+"-"+T+".json"}function a(F,U){var T=F&h,R=U.codePointAt(T/6|0);return((R=(R||48)-48)&1<<T%6)!=0}function i(F,U){var T;(T=F,T.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(R){return R.split("-").map(function(S){return parseInt(S.trim(),16)})})).forEach(function(R){var S=R[0],C=R[1];C===void 0&&(C=S),U(S,C)})}function n(F,U){i(F,function(T,R){for(var S=T;S<=R;S++)U(S)})}var o={},s={},l=new WeakMap,f="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function u(F){var U=l.get(F);return U||(U=new t,n(F.ranges,function(T){return U.add(T)}),l.set(F,U)),U}var p,g=new Map;function y(F,U,T){return F[U]?U:F[T]?T:function(R){for(var S in R)return S}(F)}function L(F,U){var T=U;if(!F.includes(T)){T=1/0;for(var R=0;R<F.length;R++)Math.abs(F[R]-U)<Math.abs(T-U)&&(T=F[R])}return T}function x(F){return p||(p=new Set,n("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(U){p.add(U)})),p.has(F)}return c.CodePointSet=t,c.clearCache=function(){o={},s={}},c.getFontsForString=function(F,U){U===void 0&&(U={});var T,R=U.lang;R===void 0&&(R=new RegExp("\\p{Script=Hangul}","u").test(T=F)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(T)?"ja":"en");var S=U.category;S===void 0&&(S="sans-serif");var C=U.style;C===void 0&&(C="normal");var I=U.weight;I===void 0&&(I=400);var M=(U.dataUrl||f).replace(/\/$/g,""),J=new Map,m=new Uint8Array(F.length),D={},w={},X=new Array(F.length),z=new Map,Z=!1;function te(d){var b=g.get(d);return b||(b=fetch(M+"/"+d).then(function(k){if(!k.ok)throw new Error(k.statusText);return k.json().then(function(A){if(!Array.isArray(A)||A[0]!==1)throw new Error("Incorrect schema version; need 1, got "+A[0]);return A[1]})}).catch(function(k){if(M!==f)return Z||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+M+'", trying default CDN. '+k.message),Z=!0),M=f,g.delete(d),te(d);throw k}),g.set(d,b)),b}for(var B=function(d){var b=F.codePointAt(d),k=e(b);X[d]=k,o[k]||z.has(k)||z.set(k,te(k).then(function(A){o[k]=A})),b>65535&&(d++,G=d)},G=0;G<F.length;G++)B(G);return Promise.all(z.values()).then(function(){z.clear();for(var d=function(k){var A=F.codePointAt(k),_=null,N=o[X[k]],E=void 0;for(var P in N){var H=w[P];if(H===void 0&&(H=w[P]=new RegExp(P).test(R||"en")),H){for(var $ in E=P,N[P])if(a(A,N[P][$])){_=$;break}break}}if(!_){e:for(var V in N)if(V!==E){for(var W in N[V])if(a(A,N[V][W])){_=W;break e}}}_||(console.debug("No font coverage for U+"+A.toString(16)),_="latin"),X[k]=_,s[_]||z.has(_)||z.set(_,te("font-meta/"+_+".json").then(function(pe){s[_]=pe})),A>65535&&(k++,b=k)},b=0;b<F.length;b++)d(b);return Promise.all(z.values())}).then(function(){for(var d,b=null,k=0;k<F.length;k++){var A=F.codePointAt(k);if(b&&(x(A)||u(b).has(A)))m[k]=m[k-1];else{b=s[X[k]];var _=D[b.id];if(!_){var N=b.typeforms,E=y(N,S,"sans-serif"),P=y(N[E],C,"normal"),H=L((d=N[E])===null||d===void 0?void 0:d[P],I);_=D[b.id]=M+"/font-files/"+b.id+"/"+E+"."+P+"."+H+".woff"}var $=J.get(_);$==null&&($=J.size,J.set(_,$)),m[k]=$}A>65535&&(k++,m[k]=m[k-1])}return{fontUrls:Array.from(J.keys()),chars:m}})},Object.defineProperty(c,"__esModule",{value:!0}),c}({})}function qn(c,t){const v=Object.create(null),h=Object.create(null);function r(a,i){const n=o=>{console.error(`Failure loading font ${a}`,o)};try{const o=new XMLHttpRequest;o.open("get",a,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status>=400)n(new Error(o.statusText));else if(o.status>0)try{const s=c(o.response);s.src=a,i(s)}catch(s){n(s)}},o.onerror=n,o.send()}catch(o){n(o)}}function e(a,i){let n=v[a];n?i(n):h[a]?h[a].push(i):(h[a]=[i],r(a,o=>{o.src=a,v[a]=o,h[a].forEach(s=>s(o)),delete h[a]}))}return function(a,i,{lang:n,fonts:o=[],style:s="normal",weight:l="normal",unicodeFontsURL:f}={}){const u=new Uint8Array(a.length),p=[];a.length||x();const g=new Map,y=[];if(s!=="italic"&&(s="normal"),typeof l!="number"&&(l=l==="bold"?700:400),o&&!Array.isArray(o)&&(o=[o]),o=o.slice().filter(U=>!U.lang||U.lang.test(n)).reverse(),o.length){let S=0;(function C(I=0){for(let M=I,J=a.length;M<J;M++){const m=a.codePointAt(M);if(S===1&&p[u[M-1]].supportsCodePoint(m)||M>0&&/\s/.test(a[M]))u[M]=u[M-1],S===2&&(y[y.length-1][1]=M);else for(let D=u[M],w=o.length;D<=w;D++)if(D===w){const X=S===2?y[y.length-1]:y[y.length]=[M,M];X[1]=M,S=2}else{u[M]=D;const{src:X,unicodeRange:z}=o[D];if(!z||F(m,z)){const Z=v[X];if(!Z){e(X,()=>{C(M)});return}if(Z.supportsCodePoint(m)){let te=g.get(Z);typeof te!="number"&&(te=p.length,p.push(Z),g.set(Z,te)),u[M]=te,S=1;break}}}m>65535&&M+1<J&&(u[M+1]=u[M],M++,S===2&&(y[y.length-1][1]=M))}L()})()}else y.push([0,a.length-1]),L();function L(){if(y.length){const U=y.map(T=>a.substring(T[0],T[1]+1)).join(`
`);t.getFontsForString(U,{lang:n||void 0,style:s,weight:l,dataUrl:f}).then(({fontUrls:T,chars:R})=>{const S=p.length;let C=0;y.forEach(M=>{for(let J=0,m=M[1]-M[0];J<=m;J++)u[M[0]+J]=R[C++]+S;C++});let I=0;T.forEach((M,J)=>{e(M,m=>{p[J+S]=m,++I===T.length&&x()})})})}else x()}function x(){i({chars:u,fonts:p})}function F(U,T){for(let R=0;R<T.length;R++){const[S,C=S]=T[R];if(S<=U&&U<=C)return!0}return!1}}}const $n=or({name:"FontResolver",dependencies:[qn,Qn,Zn],init(c,t,v){return c(t,v())}});function ea(c,t){const h=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",e=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:p,lang:g,fonts:y,style:L,weight:x,preResolvedFonts:F,unicodeFontsURL:U},T){const R=({chars:S,fonts:C})=>{let I,M;const J=[];for(let m=0;m<S.length;m++)S[m]!==M?(M=S[m],J.push(I={start:m,end:m,fontObj:C[S[m]]})):I.end=m;T(J)};F?R(F):c(p,R,{lang:g,fonts:y,style:L,weight:x,unicodeFontsURL:U})}function i({text:p="",font:g,lang:y,sdfGlyphSize:L=64,fontSize:x=400,fontWeight:F=1,fontStyle:U="normal",letterSpacing:T=0,lineHeight:R="normal",maxWidth:S=1/0,direction:C,textAlign:I="left",textIndent:M=0,whiteSpace:J="normal",overflowWrap:m="normal",anchorX:D=0,anchorY:w=0,metricsOnly:X=!1,unicodeFontsURL:z,preResolvedFonts:Z=null,includeCaretPositions:te=!1,chunkedBoundsSize:B=8192,colorRanges:G=null},d){const b=l(),k={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),x=+x,T=+T,S=+S,R=R||"normal",M=+M,a({text:p,lang:y,style:U,weight:F,fonts:typeof g=="string"?[{src:g}]:g,unicodeFontsURL:z,preResolvedFonts:Z},A=>{k.fontLoad=l()-b;const _=isFinite(S);let N=null,E=null,P=null,H=null,$=null,V=null,W=null,pe=null,ue=0,Q=0,ee=J!=="nowrap";const se=new Map,j=l();let re=M,q=0,O=new f;const he=[O];A.forEach(ne=>{const{fontObj:oe}=ne,{ascender:le,descender:de,unitsPerEm:Se,lineGap:Fe,capHeight:ge,xHeight:me}=oe;let fe=se.get(oe);if(!fe){const ce=x/Se,Ue=R==="normal"?(le-de+Fe)*ce:R*x,Xe=(Ue-(le-de)*ce)/2,_e=Math.min(Ue,(le-de)*ce),ye=(le+de)/2*ce+_e/2;fe={index:se.size,src:oe.src,fontObj:oe,fontSizeMult:ce,unitsPerEm:Se,ascender:le*ce,descender:de*ce,capHeight:ge*ce,xHeight:me*ce,lineHeight:Ue,baseline:-Xe-le*ce,caretTop:ye,caretBottom:ye-_e},se.set(oe,fe)}const{fontSizeMult:Ce}=fe,ke=p.slice(ne.start,ne.end+1);let Le,xe;oe.forEachGlyph(ke,x,T,(ce,Ue,Xe,_e)=>{Ue+=q,_e+=ne.start,Le=Ue,xe=ce;const ye=p.charAt(_e),Ae=ce.advanceWidth*Ce,Te=O.count;let ve;if("isEmpty"in ce||(ce.isWhitespace=!!ye&&new RegExp(r).test(ye),ce.canBreakAfter=!!ye&&e.test(ye),ce.isEmpty=ce.xMin===ce.xMax||ce.yMin===ce.yMax||h.test(ye)),!ce.isWhitespace&&!ce.isEmpty&&Q++,ee&&_&&!ce.isWhitespace&&Ue+Ae+re>S&&Te){if(O.glyphAt(Te-1).glyphObj.canBreakAfter)ve=new f,re=-Ue;else for(let Ge=Te;Ge--;)if(Ge===0&&m==="break-word"){ve=new f,re=-Ue;break}else if(O.glyphAt(Ge).glyphObj.canBreakAfter){ve=O.splitAt(Ge+1);const Me=ve.glyphAt(0).x;re-=Me;for(let De=ve.count;De--;)ve.glyphAt(De).x-=Me;break}ve&&(O.isSoftWrapped=!0,O=ve,he.push(O),ue=S)}let we=O.glyphAt(O.count);we.glyphObj=ce,we.x=Ue+re,we.y=Xe,we.width=Ae,we.charIndex=_e,we.fontData=fe,ye===`
`&&(O=new f,he.push(O),re=-(Ue+Ae+T*x)+M)}),q=Le+xe.advanceWidth*Ce+T*x});let K=0;he.forEach(ne=>{let oe=!0;for(let le=ne.count;le--;){const de=ne.glyphAt(le);oe&&!de.glyphObj.isWhitespace&&(ne.width=de.x+de.width,ne.width>ue&&(ue=ne.width),oe=!1);let{lineHeight:Se,capHeight:Fe,xHeight:ge,baseline:me}=de.fontData;Se>ne.lineHeight&&(ne.lineHeight=Se);const fe=me-ne.baseline;fe<0&&(ne.baseline+=fe,ne.cap+=fe,ne.ex+=fe),ne.cap=Math.max(ne.cap,ne.baseline+Fe),ne.ex=Math.max(ne.ex,ne.baseline+ge)}ne.baseline-=K,ne.cap-=K,ne.ex-=K,K+=ne.lineHeight});let ae=0,Y=0;if(D&&(typeof D=="number"?ae=-D:typeof D=="string"&&(ae=-ue*(D==="left"?0:D==="center"?.5:D==="right"?1:o(D)))),w&&(typeof w=="number"?Y=-w:typeof w=="string"&&(Y=w==="top"?0:w==="top-baseline"?-he[0].baseline:w==="top-cap"?-he[0].cap:w==="top-ex"?-he[0].ex:w==="middle"?K/2:w==="bottom"?K:w==="bottom-baseline"?-he[he.length-1].baseline:o(w)*K)),!X){const ne=t.getEmbeddingLevels(p,C);N=new Uint16Array(Q),E=new Uint8Array(Q),P=new Float32Array(Q*2),H={},W=[1/0,1/0,-1/0,-1/0],pe=[],te&&(V=new Float32Array(p.length*4)),G&&($=new Uint8Array(Q*3));let oe=0,le=-1,de=-1,Se,Fe;if(he.forEach((ge,me)=>{let{count:fe,width:Ce}=ge;if(fe>0){let ke=0;for(let _e=fe;_e--&&ge.glyphAt(_e).glyphObj.isWhitespace;)ke++;let Le=0,xe=0;if(I==="center")Le=(ue-Ce)/2;else if(I==="right")Le=ue-Ce;else if(I==="justify"&&ge.isSoftWrapped){let _e=0;for(let ye=fe-ke;ye--;)ge.glyphAt(ye).glyphObj.isWhitespace&&_e++;xe=(ue-Ce)/_e}if(xe||Le){let _e=0;for(let ye=0;ye<fe;ye++){let Ae=ge.glyphAt(ye);const Te=Ae.glyphObj;Ae.x+=Le+_e,xe!==0&&Te.isWhitespace&&ye<fe-ke&&(_e+=xe,Ae.width+=xe)}}const ce=t.getReorderSegments(p,ne,ge.glyphAt(0).charIndex,ge.glyphAt(ge.count-1).charIndex);for(let _e=0;_e<ce.length;_e++){const[ye,Ae]=ce[_e];let Te=1/0,ve=-1/0;for(let we=0;we<fe;we++)if(ge.glyphAt(we).charIndex>=ye){let Ge=we,Me=we;for(;Me<fe;Me++){let De=ge.glyphAt(Me);if(De.charIndex>Ae)break;Me<fe-ke&&(Te=Math.min(Te,De.x),ve=Math.max(ve,De.x+De.width))}for(let De=Ge;De<Me;De++){const Ie=ge.glyphAt(De);Ie.x=ve-(Ie.x+Ie.width-Te)}break}}let Ue;const Xe=_e=>Ue=_e;for(let _e=0;_e<fe;_e++){const ye=ge.glyphAt(_e);Ue=ye.glyphObj;const Ae=Ue.index,Te=ne.levels[ye.charIndex]&1;if(Te){const ve=t.getMirroredCharacter(p[ye.charIndex]);ve&&ye.fontData.fontObj.forEachGlyph(ve,0,0,Xe)}if(te){const{charIndex:ve,fontData:we}=ye,Ge=ye.x+ae,Me=ye.x+ye.width+ae;V[ve*4]=Te?Me:Ge,V[ve*4+1]=Te?Ge:Me,V[ve*4+2]=ge.baseline+we.caretBottom+Y,V[ve*4+3]=ge.baseline+we.caretTop+Y;const De=ve-le;De>1&&s(V,le,De),le=ve}if(G){const{charIndex:ve}=ye;for(;ve>de;)de++,G.hasOwnProperty(de)&&(Fe=G[de])}if(!Ue.isWhitespace&&!Ue.isEmpty){const ve=oe++,{fontSizeMult:we,src:Ge,index:Me}=ye.fontData,De=H[Ge]||(H[Ge]={});De[Ae]||(De[Ae]={path:Ue.path,pathBounds:[Ue.xMin,Ue.yMin,Ue.xMax,Ue.yMax]});const Ie=ye.x+ae,He=ye.y+ge.baseline+Y;P[ve*2]=Ie,P[ve*2+1]=He;const je=Ie+Ue.xMin*we,Ye=He+Ue.yMin*we,Qe=Ie+Ue.xMax*we,Ve=He+Ue.yMax*we;je<W[0]&&(W[0]=je),Ye<W[1]&&(W[1]=Ye),Qe>W[2]&&(W[2]=Qe),Ve>W[3]&&(W[3]=Ve),ve%B===0&&(Se={start:ve,end:ve,rect:[1/0,1/0,-1/0,-1/0]},pe.push(Se)),Se.end++;const Re=Se.rect;if(je<Re[0]&&(Re[0]=je),Ye<Re[1]&&(Re[1]=Ye),Qe>Re[2]&&(Re[2]=Qe),Ve>Re[3]&&(Re[3]=Ve),N[ve]=Ae,E[ve]=Me,G){const Ze=ve*3;$[Ze]=Fe>>16&255,$[Ze+1]=Fe>>8&255,$[Ze+2]=Fe&255}}}}}),V){const ge=p.length-le;ge>1&&s(V,le,ge)}}const be=[];se.forEach(({index:ne,src:oe,unitsPerEm:le,ascender:de,descender:Se,lineHeight:Fe,capHeight:ge,xHeight:me})=>{be[ne]={src:oe,unitsPerEm:le,ascender:de,descender:Se,lineHeight:Fe,capHeight:ge,xHeight:me}}),k.typesetting=l()-j,d({glyphIds:N,glyphFontIndices:E,glyphPositions:P,glyphData:H,fontData:be,caretPositions:V,glyphColors:$,chunkedBounds:pe,fontSize:x,topBaseline:Y+he[0].baseline,blockBounds:[ae,Y-K,ae+ue,Y],visibleBounds:W,timings:k})})}function n(p,g){i({...p,metricsOnly:!0},y=>{const[L,x,F,U]=y.blockBounds;g({width:F-L,height:U-x})})}function o(p){let g=p.match(/^([\d.]+)%$/),y=g?parseFloat(g[1]):NaN;return isNaN(y)?0:y/100}function s(p,g,y){const L=p[g*4],x=p[g*4+1],F=p[g*4+2],U=p[g*4+3],T=(x-L)/y;for(let R=0;R<y;R++){const S=(g+R)*4;p[S]=L+T*R,p[S+1]=L+T*(R+1),p[S+2]=F,p[S+3]=U}}function l(){return(self.performance||Date).now()}function f(){this.data=[]}const u=["glyphObj","x","y","width","charIndex","fontData"];return f.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/u.length)},glyphAt(p){let g=f.flyweight;return g.data=this.data,g.index=p,g},splitAt(p){let g=new f;return g.data=this.data.splice(p*u.length),g}},f.flyweight=u.reduce((p,g,y,L)=>(Object.defineProperty(p,g,{get(){return this.data[this.index*u.length+y]},set(x){this.data[this.index*u.length+y]=x}}),p),{data:null,index:0}),{typeset:i,measure:n}}const $e=()=>(self.performance||Date).now(),Ir=nn();let Ht;function ra(c,t,v,h,r,e,a,i,n,o,s=!0){return s?na(c,t,v,h,r,e,a,i,n,o).then(null,l=>(Ht||(console.warn("WebGL SDF generation failed, falling back to JS",l),Ht=!0),Jt(c,t,v,h,r,e,a,i,n,o))):Jt(c,t,v,h,r,e,a,i,n,o)}const Or=[],ta=5;let ht=0;function on(){const c=$e();for(;Or.length&&$e()-c<ta;)Or.shift()();ht=Or.length?setTimeout(on,0):0}const na=(...c)=>new Promise((t,v)=>{Or.push(()=>{const h=$e();try{Ir.webgl.generateIntoCanvas(...c),t({timing:$e()-h})}catch(r){v(r)}}),ht||(ht=setTimeout(on,0))}),aa=4,oa=2e3,Yt={};let ia=0;function Jt(c,t,v,h,r,e,a,i,n,o){const s="TroikaTextSDFGenerator_JS_"+ia++%aa;let l=Yt[s];return l||(l=Yt[s]={workerModule:or({name:s,workerId:s,dependencies:[nn,$e],init(f,u){const p=f().javascript.generate;return function(...g){const y=u();return{textureData:p(...g),timing:u()-y}}},getTransferables(f){return[f.textureData.buffer]}}),requests:0,idleTimer:null}),l.requests++,clearTimeout(l.idleTimer),l.workerModule(c,t,v,h,r,e).then(({textureData:f,timing:u})=>{const p=$e(),g=new Uint8Array(f.length*4);for(let y=0;y<f.length;y++)g[y*4+o]=f[y];return Ir.webglUtils.renderImageData(a,g,i,n,c,t,1<<3-o),u+=$e()-p,--l.requests===0&&(l.idleTimer=setTimeout(()=>{Bn(s)},oa)),{timing:u}})}function sa(c){c._warm||(Ir.webgl.isSupported(c),c._warm=!0)}const fa=Ir.webglUtils.resizeWebGLCanvasWithoutClearing,mr={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},la=new Pr;function ar(){return(self.performance||Date).now()}const Kt=Object.create(null);function sn(c,t){c=ca({},c);const v=ar(),h=[];if(c.font&&h.push({label:"user",src:ha(c.font)}),c.font=h,c.text=""+c.text,c.sdfGlyphSize=c.sdfGlyphSize||mr.sdfGlyphSize,c.unicodeFontsURL=c.unicodeFontsURL||mr.unicodeFontsURL,c.colorRanges!=null){let f={};for(let u in c.colorRanges)if(c.colorRanges.hasOwnProperty(u)){let p=c.colorRanges[u];typeof p!="number"&&(p=la.set(p).getHex()),f[u]=p}c.colorRanges=f}Object.freeze(c);const{textureWidth:r,sdfExponent:e}=mr,{sdfGlyphSize:a}=c,i=r/a*4;let n=Kt[a];if(!n){const f=document.createElement("canvas");f.width=r,f.height=a*256/i,n=Kt[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:f,sdfTexture:new Dn(f,void 0,void 0,void 0,It,It),contextLost:!1,glyphsByFont:new Map},n.sdfTexture.generateMipmaps=!1,ua(n)}const{sdfTexture:o,sdfCanvas:s}=n;un(c).then(f=>{const{glyphIds:u,glyphFontIndices:p,fontData:g,glyphPositions:y,fontSize:L,timings:x}=f,F=[],U=new Float32Array(u.length*4);let T=0,R=0;const S=ar(),C=g.map(D=>{let w=n.glyphsByFont.get(D.src);return w||n.glyphsByFont.set(D.src,w=new Map),w});u.forEach((D,w)=>{const X=p[w],{src:z,unitsPerEm:Z}=g[X];let te=C[X].get(D);if(!te){const{path:k,pathBounds:A}=f.glyphData[z][D],_=Math.max(A[2]-A[0],A[3]-A[1])/a*(mr.sdfMargin*a+.5),N=n.glyphCount++,E=[A[0]-_,A[1]-_,A[2]+_,A[3]+_];C[X].set(D,te={path:k,atlasIndex:N,sdfViewBox:E}),F.push(te)}const{sdfViewBox:B}=te,G=y[R++],d=y[R++],b=L/Z;U[T++]=G+B[0]*b,U[T++]=d+B[1]*b,U[T++]=G+B[2]*b,U[T++]=d+B[3]*b,u[w]=te.atlasIndex}),x.quads=(x.quads||0)+(ar()-S);const I=ar();x.sdf={};const M=s.height,J=Math.ceil(n.glyphCount/i),m=Math.pow(2,Math.ceil(Math.log2(J*a)));m>M&&(console.info(`Increasing SDF texture size ${M}->${m}`),fa(s,r,m),o.dispose()),Promise.all(F.map(D=>fn(D,n,c.gpuAccelerateSDF).then(({timing:w})=>{x.sdf[D.atlasIndex]=w}))).then(()=>{F.length&&!n.contextLost&&(ln(n),o.needsUpdate=!0),x.sdfTotal=ar()-I,x.total=ar()-v,t(Object.freeze({parameters:c,sdfTexture:o,sdfGlyphSize:a,sdfExponent:e,glyphBounds:U,glyphAtlasIndices:u,glyphColors:f.glyphColors,caretPositions:f.caretPositions,chunkedBounds:f.chunkedBounds,ascender:f.ascender,descender:f.descender,lineHeight:f.lineHeight,capHeight:f.capHeight,xHeight:f.xHeight,topBaseline:f.topBaseline,blockBounds:f.blockBounds,visibleBounds:f.visibleBounds,timings:f.timings}))})}),Promise.resolve().then(()=>{n.contextLost||sa(s)})}function fn({path:c,atlasIndex:t,sdfViewBox:v},{sdfGlyphSize:h,sdfCanvas:r,contextLost:e},a){if(e)return Promise.resolve({timing:-1});const{textureWidth:i,sdfExponent:n}=mr,o=Math.max(v[2]-v[0],v[3]-v[1]),s=Math.floor(t/4),l=s%(i/h)*h,f=Math.floor(s/(i/h))*h,u=t%4;return ra(h,h,c,v,o,n,r,l,f,u,a)}function ua(c){const t=c.sdfCanvas;t.addEventListener("webglcontextlost",v=>{console.log("Context Lost",v),v.preventDefault(),c.contextLost=!0}),t.addEventListener("webglcontextrestored",v=>{console.log("Context Restored",v),c.contextLost=!1;const h=[];c.glyphsByFont.forEach(r=>{r.forEach(e=>{h.push(fn(e,c,!0))})}),Promise.all(h).then(()=>{ln(c),c.sdfTexture.needsUpdate=!0})})}function Aa({font:c,characters:t,sdfGlyphSize:v},h){let r=Array.isArray(t)?t.join(`
`):""+t;sn({font:c,sdfGlyphSize:v,text:r},h)}function ca(c,t){for(let v in t)t.hasOwnProperty(v)&&(c[v]=t[v]);return c}let Gr;function ha(c){return Gr||(Gr=typeof document>"u"?{}:document.createElement("a")),Gr.href=c,Gr.href}function ln(c){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:t,sdfTexture:v}=c,{width:h,height:r}=t,e=c.sdfCanvas.getContext("webgl");let a=v.image.data;(!a||a.length!==h*r*4)&&(a=new Uint8Array(h*r*4),v.image={width:h,height:r,data:a},v.flipY=!1,v.isDataTexture=!0),e.readPixels(0,0,h,r,e.RGBA,e.UNSIGNED_BYTE,a)}}const da=or({name:"Typesetter",dependencies:[ea,$n,In],init(c,t,v){return c(t,v())}}),un=or({name:"Typesetter",dependencies:[da],init(c){return function(t){return new Promise(v=>{c.typeset(t,v)})}},getTransferables(c){const t=[];for(let v in c)c[v]&&c[v].buffer&&t.push(c[v].buffer);return t}});un.onMainThread;const Qt={};function va(c){let t=Qt[c];return t||(t=Qt[c]=new pt(1,1,c,c).translate(.5,.5,0)),t}const pa="aTroikaGlyphBounds",Zt="aTroikaGlyphIndex",ga="aTroikaGlyphColor";class ma extends Fn{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Cn,this.boundingBox=new rn}computeBoundingSphere(){}computeBoundingBox(){}set detail(t){if(t!==this._detail){this._detail=t,(typeof t!="number"||t<1)&&(t=1);let v=va(t);["position","normal","uv"].forEach(h=>{this.attributes[h]=v.attributes[h].clone()}),this.setIndex(v.getIndex().clone())}}get detail(){return this._detail}set curveRadius(t){t!==this._curveRadius&&(this._curveRadius=t,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(t,v,h,r,e){this.updateAttributeData(pa,t,4),this.updateAttributeData(Zt,v,1),this.updateAttributeData(ga,e,3),this._blockBounds=h,this._chunkedBounds=r,this.instanceCount=v.length,this._updateBounds()}_updateBounds(){const t=this._blockBounds;if(t){const{curveRadius:v,boundingBox:h}=this;if(v){const{PI:r,floor:e,min:a,max:i,sin:n,cos:o}=Math,s=r/2,l=r*2,f=Math.abs(v),u=t[0]/f,p=t[2]/f,g=e((u+s)/l)!==e((p+s)/l)?-f:a(n(u)*f,n(p)*f),y=e((u-s)/l)!==e((p-s)/l)?f:i(n(u)*f,n(p)*f),L=e((u+r)/l)!==e((p+r)/l)?f*2:i(f-o(u)*f,f-o(p)*f);h.min.set(g,t[1],v<0?-L:0),h.max.set(y,t[3],v<0?0:L)}else h.min.set(t[0],t[1],0),h.max.set(t[2],t[3],0);h.getBoundingSphere(this.boundingSphere)}}applyClipRect(t){let v=this.getAttribute(Zt).count,h=this._chunkedBounds;if(h)for(let r=h.length;r--;){v=h[r].end;let e=h[r].rect;if(e[1]<t.w&&e[3]>t.y&&e[0]<t.z&&e[2]>t.x)break}this.instanceCount=v}updateAttributeData(t,v,h){const r=this.getAttribute(t);v?r&&r.array.length===v.length?(r.array.set(v),r.needsUpdate=!0):(this.setAttribute(t,new An(v,h)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(t)}}const ya=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,ba=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Ua=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,_a=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Sa(c){const t=ct(c,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Br},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Nt(0,0,0,0)},uTroikaClipRect:{value:new Nt(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Br},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Pr},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Mn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:ya,vertexTransform:ba,fragmentDefs:Ua,fragmentColorTransform:_a,customRewriter({vertexShader:v,fragmentShader:h}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(h)&&(h=h.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(v)||(v=v.replace(an,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:v,fragmentShader:h}}});return t.transparent=!0,t.forceSinglePass=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),t}const gt=new Tn({color:16777215,side:En,transparent:!0}),qt=8421504,$t=new wn,Rr=new vt,st=new vt,gr=[],xa=new vt,ft="+x+y";function en(c){return Array.isArray(c)?c[0]:c}let cn=()=>{const c=new dt(new pt(1,1),gt);return cn=()=>c,c},hn=()=>{const c=new dt(new pt(1,1,32,1),gt);return hn=()=>c,c};const ka={type:"syncstart"},Ta={type:"synccomplete"},dn=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],wa=dn.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class Fa extends dt{constructor(){const t=new ma;super(t,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=qt,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=ft,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(t){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(t):(this._isSyncing=!0,this.dispatchEvent(ka),sn({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},v=>{this._isSyncing=!1,this._textRenderInfo=v,this.geometry.updateGlyphs(v.glyphBounds,v.glyphAtlasIndices,v.blockBounds,v.chunkedBounds,v.glyphColors);const h=this._queuedSyncs;h&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{h.forEach(r=>r&&r())})),this.dispatchEvent(Ta),t&&t()})))}onBeforeRender(t,v,h,r,e,a){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(t){return Sa(t)}get material(){let t=this._derivedMaterial;const v=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=gt.clone());if((!t||!t.isDerivedFrom(v))&&(t=this._derivedMaterial=this.createDerivedMaterial(v),v.addEventListener("dispose",function h(){v.removeEventListener("dispose",h),t.dispose()})),this.hasOutline()){let h=t._outlineMtl;return h||(h=t._outlineMtl=Object.create(t,{id:{value:t.id+.1}}),h.isTextOutlineMaterial=!0,h.depthWrite=!1,h.map=null,t.addEventListener("dispose",function r(){t.removeEventListener("dispose",r),h.dispose()})),[h,t]}else return t}set material(t){t&&t.isTroikaTextMaterial?(this._derivedMaterial=t,this._baseMaterial=t.baseMaterial):this._baseMaterial=t}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(t){this.geometry.detail=t}get curveRadius(){return this.geometry.curveRadius}set curveRadius(t){this.geometry.curveRadius=t}get customDepthMaterial(){return en(this.material).getDepthMaterial()}get customDistanceMaterial(){return en(this.material).getDistanceMaterial()}_prepareForRender(t){const v=t.isTextOutlineMaterial,h=t.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:i,blockBounds:n}=r;h.uTroikaSDFTexture.value=i,h.uTroikaSDFTextureSize.value.set(i.image.width,i.image.height),h.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,h.uTroikaSDFExponent.value=r.sdfExponent,h.uTroikaTotalBounds.value.fromArray(n),h.uTroikaUseGlyphColors.value=!v&&!!r.glyphColors;let o=0,s=0,l=0,f,u,p,g=0,y=0;if(v){let{outlineWidth:x,outlineOffsetX:F,outlineOffsetY:U,outlineBlur:T,outlineOpacity:R}=this;o=this._parsePercent(x)||0,s=Math.max(0,this._parsePercent(T)||0),f=R,g=this._parsePercent(F)||0,y=this._parsePercent(U)||0}else l=Math.max(0,this._parsePercent(this.strokeWidth)||0),l&&(p=this.strokeColor,h.uTroikaStrokeColor.value.set(p??qt),u=this.strokeOpacity,u==null&&(u=1)),f=this.fillOpacity;h.uTroikaEdgeOffset.value=o,h.uTroikaPositionOffset.value.set(g,y),h.uTroikaBlurRadius.value=s,h.uTroikaStrokeWidth.value=l,h.uTroikaStrokeOpacity.value=u,h.uTroikaFillOpacity.value=f??1,h.uTroikaCurveRadius.value=this.curveRadius||0;let L=this.clipRect;if(L&&Array.isArray(L)&&L.length===4)h.uTroikaClipRect.value.fromArray(L);else{const x=(this.fontSize||.1)*100;h.uTroikaClipRect.value.set(n[0]-x,n[1]-x,n[2]+x,n[3]+x)}this.geometry.applyClipRect(h.uTroikaClipRect.value)}h.uTroikaSDFDebug.value=!!this.debugSDF,t.polygonOffset=!!this.depthOffset,t.polygonOffsetFactor=t.polygonOffsetUnits=this.depthOffset||0;const e=v?this.outlineColor||0:this.color;if(e==null)delete t.color;else{const i=t.hasOwnProperty("color")?t.color:t.color=new Pr;(e!==i._input||typeof e=="object")&&i.set(i._input=e)}let a=this.orientation||ft;if(a!==t._orientation){let i=h.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let n=a!==ft&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,o,s,l,f]=n;Rr.set(0,0,0)[s]=o==="-"?1:-1,st.set(0,0,0)[f]=l==="-"?-1:1,$t.lookAt(xa,Rr.cross(st),st),i.setFromMatrix4($t)}else i.identity();t._orientation=a}}_parsePercent(t){if(typeof t=="string"){let v=t.match(/^(-?[\d.]+)%$/),h=v?parseFloat(v[1]):NaN;t=(isNaN(h)?0:h/100)*this.fontSize}return t}localPositionToTextCoords(t,v=new Br){v.copy(t);const h=this.curveRadius;return h&&(v.x=Math.atan2(t.x,Math.abs(h)-Math.abs(t.z))*Math.abs(h)),v}worldPositionToTextCoords(t,v=new Br){return Rr.copy(t),this.localPositionToTextCoords(this.worldToLocal(Rr),v)}raycast(t,v){const{textRenderInfo:h,curveRadius:r}=this;if(h){const e=h.blockBounds,a=r?hn():cn(),i=a.geometry,{position:n,uv:o}=i.attributes;for(let s=0;s<o.count;s++){let l=e[0]+o.getX(s)*(e[2]-e[0]);const f=e[1]+o.getY(s)*(e[3]-e[1]);let u=0;r&&(u=r-Math.cos(l/r)*r,l=Math.sin(l/r)*r),n.setXYZ(s,l,f,u)}i.boundingSphere=this.geometry.boundingSphere,i.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,gr.length=0,a.raycast(t,gr);for(let s=0;s<gr.length;s++)gr[s].object=this,v.push(gr[s])}}copy(t){const v=this.geometry;return super.copy(t),this.geometry=v,wa.forEach(h=>{this[h]=t[h]}),this}clone(){return new this.constructor().copy(this)}}dn.forEach(c=>{const t="_private_"+c;Object.defineProperty(Fa.prototype,c,{get(){return this[t]},set(v){v!==this[t]&&(this[t]=v,this._needsSync=!0)}})});new rn;new Pr;export{Fa as T,Aa as p};
